(self.webpackChunksurvey_king=self.webpackChunksurvey_king||[]).push([[346],{66023:function(ae,R){"use strict";var e={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M884 256h-75c-5.1 0-9.9 2.5-12.9 6.6L512 654.2 227.9 262.6c-3-4.1-7.8-6.6-12.9-6.6h-75c-6.5 0-10.3 7.4-6.5 12.7l352.6 486.1c12.8 17.6 39 17.6 51.7 0l352.6-486.1c3.9-5.3.1-12.7-6.4-12.7z"}}]},name:"down",theme:"outlined"};R.Z=e},34804:function(ae,R,e){"use strict";var B=e(28991),S=e(67294),W=e(66023),K=e(27029),x=function(V,k){return S.createElement(K.Z,(0,B.Z)((0,B.Z)({},V),{},{ref:k,icon:W.Z}))},D=S.forwardRef(x);R.Z=D},59271:function(ae,R,e){"use strict";e.d(R,{Z:function(){return V}});var B=e(28991),S=e(67294),W={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M946.5 505L560.1 118.8l-25.9-25.9a31.5 31.5 0 00-44.4 0L77.5 505a63.9 63.9 0 00-18.8 46c.4 35.2 29.7 63.3 64.9 63.3h42.5V940h691.8V614.3h43.4c17.1 0 33.2-6.7 45.3-18.8a63.6 63.6 0 0018.7-45.3c0-17-6.7-33.1-18.8-45.2zM568 868H456V664h112v204zm217.9-325.7V868H632V640c0-22.1-17.9-40-40-40H432c-22.1 0-40 17.9-40 40v228H238.1V542.3h-96l370-369.7 23.1 23.1L882 542.3h-96.1z"}}]},name:"home",theme:"outlined"},K=W,x=e(27029),D=function(ie,M){return S.createElement(x.Z,(0,B.Z)((0,B.Z)({},ie),{},{ref:M,icon:K}))},y=S.forwardRef(D),V=y},81262:function(){},18727:function(ae,R,e){"use strict";e.r(R),e.d(R,{Practice:function(){return _},default:function(){return U}});var B=e(36017),S=e(35247),W=e(71194),K=e(50146),x=e(11849),D=e(39428),y=e(3182),V=e(68068),k=e(9761),ie=e(78864),M=e(67294),se=e(5977);const Se="Left",fe="Right",me="Up",he="Down",F={delta:10,preventScrollOnSwipe:!1,rotationAngle:0,trackMouse:!1,trackTouch:!0,swipeDuration:Infinity,touchEventOptions:{passive:!0}},oe={first:!0,initial:[0,0],start:0,swiping:!1,xy:[0,0]},ge="mousemove",Oe="mouseup",pe="touchend",xe="touchmove",ce="touchstart";function je(i,f,l,m){return i>f?l>0?fe:Se:m>0?he:me}function ye(i,f){if(f===0)return i;const l=Math.PI/180*f,m=i[0]*Math.cos(l)+i[1]*Math.sin(l),T=i[1]*Math.cos(l)-i[0]*Math.sin(l);return[m,T]}function d(i,f){const l=n=>{const s="touches"in n;s&&n.touches.length>1||i((o,v)=>{v.trackMouse&&!s&&(document.addEventListener(ge,m),document.addEventListener(Oe,E));const{clientX:a,clientY:N}=s?n.touches[0]:n,A=ye([a,N],v.rotationAngle);return v.onTouchStartOrOnMouseDown&&v.onTouchStartOrOnMouseDown({event:n}),Object.assign(Object.assign(Object.assign({},o),oe),{initial:A.slice(),xy:A,start:n.timeStamp||0})})},m=n=>{i((s,o)=>{const v="touches"in n;if(v&&n.touches.length>1)return s;if(n.timeStamp-s.start>o.swipeDuration)return s.swiping?Object.assign(Object.assign({},s),{swiping:!1}):s;const{clientX:a,clientY:N}=v?n.touches[0]:n,[A,ee]=ye([a,N],o.rotationAngle),ne=A-s.xy[0],te=ee-s.xy[1],Y=Math.abs(ne),w=Math.abs(te),G=(n.timeStamp||0)-s.start,ue=Math.sqrt(Y*Y+w*w)/(G||1),Pe=[ne/(G||1),te/(G||1)],le=je(Y,w,ne,te),be=typeof o.delta=="number"?o.delta:o.delta[le.toLowerCase()]||F.delta;if(Y<be&&w<be&&!s.swiping)return s;const de={absX:Y,absY:w,deltaX:ne,deltaY:te,dir:le,event:n,first:s.first,initial:s.initial,velocity:ue,vxvy:Pe};de.first&&o.onSwipeStart&&o.onSwipeStart(de),o.onSwiping&&o.onSwiping(de);let Me=!1;return(o.onSwiping||o.onSwiped||o[`onSwiped${le}`])&&(Me=!0),Me&&o.preventScrollOnSwipe&&o.trackTouch&&n.cancelable&&n.preventDefault(),Object.assign(Object.assign({},s),{first:!1,eventData:de,swiping:!0})})},T=n=>{i((s,o)=>{let v;if(s.swiping&&s.eventData){if(n.timeStamp-s.start<o.swipeDuration){v=Object.assign(Object.assign({},s.eventData),{event:n}),o.onSwiped&&o.onSwiped(v);const a=o[`onSwiped${v.dir}`];a&&a(v)}}else o.onTap&&o.onTap({event:n});return o.onTouchEndOrOnMouseUp&&o.onTouchEndOrOnMouseUp({event:n}),Object.assign(Object.assign(Object.assign({},s),oe),{eventData:v})})},C=()=>{document.removeEventListener(ge,m),document.removeEventListener(Oe,E)},E=n=>{C(),T(n)},P=(n,s)=>{let o=()=>{};if(n&&n.addEventListener){const v=Object.assign(Object.assign({},F.touchEventOptions),s.touchEventOptions),a=[[ce,l,v],[xe,m,Object.assign(Object.assign({},v),s.preventScrollOnSwipe?{passive:!1}:{})],[pe,T,v]];a.forEach(([N,A,ee])=>n.addEventListener(N,A,ee)),o=()=>a.forEach(([N,A])=>n.removeEventListener(N,A))}return o},Q={ref:n=>{n!==null&&i((s,o)=>{if(s.el===n)return s;const v={};return s.el&&s.el!==n&&s.cleanUpTouch&&(s.cleanUpTouch(),v.cleanUpTouch=void 0),o.trackTouch&&n&&(v.cleanUpTouch=P(n,o)),Object.assign(Object.assign(Object.assign({},s),{el:n}),v)})}};return f.trackMouse&&(Q.onMouseDown=l),[Q,P]}function t(i,f,l,m){return!f.trackTouch||!i.el?(i.cleanUpTouch&&i.cleanUpTouch(),Object.assign(Object.assign({},i),{cleanUpTouch:void 0})):i.cleanUpTouch?f.preventScrollOnSwipe!==l.preventScrollOnSwipe||f.touchEventOptions.passive!==l.touchEventOptions.passive?(i.cleanUpTouch(),Object.assign(Object.assign({},i),{cleanUpTouch:m(i.el,f)})):i:Object.assign(Object.assign({},i),{cleanUpTouch:m(i.el,f)})}function g(i){const{trackMouse:f}=i,l=M.useRef(Object.assign({},oe)),m=M.useRef(Object.assign({},F)),T=M.useRef(Object.assign({},m.current));T.current=Object.assign({},m.current),m.current=Object.assign(Object.assign({},F),i);let C;for(C in F)m.current[C]===void 0&&(m.current[C]=F[C]);const[E,P]=M.useMemo(()=>d(L=>l.current=L(l.current,m.current),{trackMouse:f}),[f]);return l.current=t(l.current,m.current,T.current,P),E}var r=e(92725),u=e(12997),b=e(96389),z=e(42285),I=e(78210),H=e(3980),X=e(32235),J=e(27400),q=e(59271),c=e(85893),_=(0,k.Pi)(function(){var i,f,l,m,T=(0,se.UO)(),C=T.id,E=T.answerId,P=(0,se.TH)(),L=P.query.preview==="1",Q=P.query.pattern,n=P.query.openid,s=P.query.ptype,o=(0,M.useMemo)(function(){return(0,b.SB)()},[]),v=(0,M.useRef)(null),a=(0,M.useMemo)(function(){return new X.b({surveyRef:v,id:"exercise",answerId:E,repoId:C,examExerciseType:s})},[v,C,E]),N=(0,J.a)();(0,M.useEffect)(function(){N.currentUser()},[N]);var A=a.saving,ee=a.loading,ne=(i=a.setting)===null||i===void 0?void 0:i.answerSetting,te=a.loginRequired,Y=a.verifying,w=ne||{},G=w.autoSave,ue=w.progressBar,Pe=w.initialValues,le=w.questionNumber,be=w.wechatOnly,de=w.onePageOneQuestion,Me=w.answerSheetVisible,Ue=w.triggerType,Le=w.copyEnabled,Ce=((f=a.setting)===null||f===void 0?void 0:f.examSetting)||{},Fe=Ce.exerciseMode,ze=Ce.maxSwitchScreenTimes,Ne=!!((l=a.setting)!==null&&l!==void 0&&(m=l.examSetting)!==null&&m!==void 0&&m.randomSurveyWrong),Ae=a.errorMessage,we=a.savedAnswer,Ze=a.confirmTempAnswerType,$e=a.statistics,re=a.survey,Re=a.answerId,De=a.mode,Ee=a.success,Ie=(0,b.XO)(re,P);(0,M.useEffect)(function(){re&&(0,b.iq)(re,"statEnabled","quota")&&a.loadStatistics()},[re,a]);var Xe=g({onSwipedLeft:function(){var O;(O=v.current)===null||O===void 0||O.getStore().handleNext()},onSwipedRight:function(){var O;(O=v.current)===null||O===void 0||O.getStore().handlePrev()}}),Ve=(0,M.useCallback)(function($,O){ue&&a.changeProgress(O),G&&$&&a.tempSave($)},[ue]),He=function(){return(0,c.jsx)(u.BW,{})},Be=function(O){var p,h;return(0,c.jsxs)("div",{className:"render-failure ".concat(o?"mobile":"phone"),children:[((p=a.project)===null||p===void 0?void 0:p.name)&&(0,c.jsx)("div",{className:"title",children:(h=a.project)===null||h===void 0?void 0:h.name}),(0,c.jsxs)("div",{className:"content",children:[(0,c.jsx)("div",{children:(0,c.jsx)(u.AT,{})}),(0,c.jsx)("h2",{children:Ae||O}),(0,c.jsx)("div",{children:"\u611F\u8C22\u5173\u6CE8\uFF01"})]})]})},We=function(){if(Ee)return(0,c.jsx)(c.Fragment,{});if(ee)return(0,c.jsx)(r.Z,{});if(a.errorCode!==200)return Be();if(be&&!(0,b.CL)())return Be("\u53EA\u80FD\u5728\u5FAE\u4FE1\u4E2D\u6253\u5F00");if(te)return(0,c.jsx)("div",{children:He()});if(re&&!Ee&&!Y)return Ze===1&&G&&De==="survey"&&!Re?(0,c.jsx)(u.oq,{}):(0,c.jsx)("div",{style:{userSelect:Le===!1?"none":"unset"},children:(0,c.jsx)(V.Z,{ref:v,mode:De,loading:A||ee,progressBar:ue,questionNumber:le,theme:o?"antdMobile":"antd",schema:re,onChange:Ve,onePageOneQuestion:!0,answerSheetVisible:!0,exerciseMode:!0,wrongMode:Ne,pattern:Q,triggerType:Ue,onInit:function(p){a.tempSave(p.values)},initialQuestionScore:a.initialQuestionScore,onDictSearch:function(){var O=(0,y.Z)((0,D.Z)().mark(function p(h){var Z;return(0,D.Z)().wrap(function(j){for(;;)switch(j.prev=j.next){case 0:return j.next=2,H.hi.loadDict(h);case 2:if(Z=j.sent,!Z.success){j.next=5;break}return j.abrupt("return",Z.data);case 5:return j.abrupt("return",[]);case 6:case"end":return j.stop()}},p)}));return function(p){return O.apply(this,arguments)}}(),initialValues:Ze===3?Ie:(0,x.Z)((0,x.Z)((0,x.Z)((0,x.Z)({},Pe),G?we==null?void 0:we.answer:{}),Ie),a.values),statistics:$e,onUpload:function(p,h){return a.upload(p,h)},footerVisible:!(L||Q==="readPretty"),headerVisible:!L,isPreview:L,onLink:function(p){H.hi.loadLinkResult((0,x.Z)((0,x.Z)({},p),{},{projectId:C})).then(function(h){if(h.success&&h.data.answer){var Z=h.data.answer;Object.keys(Z).forEach(function(ve){var j=Z[ve];if(p.questionId!==ve){var Te;(Te=v.current)===null||Te===void 0||Te.setValue(ve,j)}})}})},onSubmit:function(p){a.saveData((0,x.Z)((0,x.Z)({},p),{},{openid:n}),{answerId:Re}).then(function(h){!(h!=null&&h.success)&&h!==null&&h!==void 0&&h.message&&(o?ie.u_.alert({title:"\u4FDD\u5B58\u5931\u8D25",content:(0,c.jsx)(I.Z,{html:h.message})}):K.Z.error({title:"\u4FDD\u5B58\u5931\u8D25",content:(0,c.jsx)(I.Z,{html:h.message}),okText:"\u77E5\u9053\u4E86"}))})},onNote:function(p,h){H.hi.updateUserBook({templateId:p,note:h})},onLazyLoad:function(){var O=(0,y.Z)((0,D.Z)().mark(function p(h){var Z;return(0,D.Z)().wrap(function(j){for(;;)switch(j.prev=j.next){case 0:return j.next=2,H.hi.getTemplate({id:h});case 2:return Z=j.sent,j.abrupt("return",(0,x.Z)((0,x.Z)({},Z),{},{schema:Z==null?void 0:Z.template}));case 4:case"end":return j.stop()}},p)}));return function(p){return O.apply(this,arguments)}}()})})};(0,M.useEffect)(function(){Ee&&z.m8.push("/exercise")},[Ee]);var Ke=function(){var O,p,h=(O=a.survey)===null||O===void 0||(p=O.attribute)===null||p===void 0?void 0:p.backgroundImage;if(h)return{backgroundImage:"url(/api/public/preview/".concat(h,")")}};return(0,c.jsxs)(b.ff.Provider,{value:a,children:[(0,c.jsx)("div",{style:{padding:20},children:(0,c.jsxs)(S.Z,{children:[(0,c.jsxs)(S.Z.Item,{onClick:function(){return z.m8.push("/")},children:[(0,c.jsx)(q.Z,{}),"\u9996\u9875"]}),(0,c.jsx)(S.Z.Item,{onClick:function(){return z.m8.push("/exercise")},children:"\u5728\u7EBF\u7EC3\u4E60"})]})}),(0,c.jsx)("div",{className:"survey ".concat(o?"mobile":"pc"),style:Ke(),children:We()})]})}),U=function(){var i=(0,se.UO)(),f=i.id,l=f===void 0?"":f,m=i.answerId;return(0,c.jsx)(_,{id:l,aId:m})}},35247:function(ae,R,e){"use strict";e.d(R,{Z:function(){return ye}});var B=e(96156),S=e(22122),W=e(85061),K=e(94184),x=e.n(K),D=e(50344),y=e(67294),V=e(53124),k=e(28682),ie=e(96159),M=e(34804),se=e(81555),Se=function(d,t){var g={};for(var r in d)Object.prototype.hasOwnProperty.call(d,r)&&t.indexOf(r)<0&&(g[r]=d[r]);if(d!=null&&typeof Object.getOwnPropertySymbols=="function")for(var u=0,r=Object.getOwnPropertySymbols(d);u<r.length;u++)t.indexOf(r[u])<0&&Object.prototype.propertyIsEnumerable.call(d,r[u])&&(g[r[u]]=d[r[u]]);return g},fe=function(t){var g=t.prefixCls,r=t.separator,u=r===void 0?"/":r,b=t.children,z=t.menu,I=t.overlay,H=t.dropdownProps,X=Se(t,["prefixCls","separator","children","menu","overlay","dropdownProps"]),J=y.useContext(V.E_),q=J.getPrefixCls,c=q("breadcrumb",g),_=function(f){if(z||I){var l=(0,S.Z)({},H);return"overlay"in t&&(l.overlay=I),y.createElement(se.Z,(0,S.Z)({menu:z,placement:"bottom"},l),y.createElement("span",{className:"".concat(c,"-overlay-link")},f,y.createElement(M.Z,null)))}return f},U;return"href"in X?U=y.createElement("a",(0,S.Z)({className:"".concat(c,"-link")},X),b):U=y.createElement("span",(0,S.Z)({className:"".concat(c,"-link")},X),b),U=_(U),b!=null?y.createElement("li",null,U,u&&y.createElement("span",{className:"".concat(c,"-separator")},u)):null};fe.__ANT_BREADCRUMB_ITEM=!0;var me=fe,he=function(t){var g=t.children,r=y.useContext(V.E_),u=r.getPrefixCls,b=u("breadcrumb");return y.createElement("span",{className:"".concat(b,"-separator")},g||"/")};he.__ANT_BREADCRUMB_SEPARATOR=!0;var F=he,oe=function(d,t){var g={};for(var r in d)Object.prototype.hasOwnProperty.call(d,r)&&t.indexOf(r)<0&&(g[r]=d[r]);if(d!=null&&typeof Object.getOwnPropertySymbols=="function")for(var u=0,r=Object.getOwnPropertySymbols(d);u<r.length;u++)t.indexOf(r[u])<0&&Object.prototype.propertyIsEnumerable.call(d,r[u])&&(g[r[u]]=d[r[u]]);return g};function ge(d,t){if(!d.breadcrumbName)return null;var g=Object.keys(t).join("|"),r=d.breadcrumbName.replace(new RegExp(":(".concat(g,")"),"g"),function(u,b){return t[b]||u});return r}function Oe(d,t,g,r){var u=g.indexOf(d)===g.length-1,b=ge(d,t);return u?y.createElement("span",null,b):y.createElement("a",{href:"#/".concat(r.join("/"))},b)}var pe=function(t,g){return t=(t||"").replace(/^\//,""),Object.keys(g).forEach(function(r){t=t.replace(":".concat(r),g[r])}),t},xe=function(t,g,r){var u=(0,W.Z)(t),b=pe(g||"",r);return b&&u.push(b),u},ce=function(t){var g=t.prefixCls,r=t.separator,u=r===void 0?"/":r,b=t.style,z=t.className,I=t.routes,H=t.children,X=t.itemRender,J=X===void 0?Oe:X,q=t.params,c=q===void 0?{}:q,_=oe(t,["prefixCls","separator","style","className","routes","children","itemRender","params"]),U=y.useContext(V.E_),i=U.getPrefixCls,f=U.direction,l,m=i("breadcrumb",g);if(I&&I.length>0){var T=[];l=I.map(function(E){var P=pe(E.path,c);P&&T.push(P);var L;E.children&&E.children.length&&(L=y.createElement(k.Z,{items:E.children.map(function(n){return{key:n.path||n.breadcrumbName,label:J(n,c,I,xe(T,n.path,c))}})}));var Q={separator:u};return L&&(Q.overlay=L),y.createElement(me,(0,S.Z)({},Q,{key:P||E.breadcrumbName}),J(E,c,I,T))})}else H&&(l=(0,D.Z)(H).map(function(E,P){return E&&(0,ie.Tm)(E,{separator:u,key:P})}));var C=x()(m,(0,B.Z)({},"".concat(m,"-rtl"),f==="rtl"),z);return y.createElement("nav",(0,S.Z)({className:C,style:b},_),y.createElement("ol",null,l))};ce.Item=me,ce.Separator=F;var je=ce,ye=je},36017:function(ae,R,e){"use strict";var B=e(38663),S=e.n(B),W=e(81262),K=e.n(W),x=e(59250),D=e(30887)}}]);
