(self.webpackChunksurvey_king=self.webpackChunksurvey_king||[]).push([[2944],{17707:function(ye,D,l){"use strict";l.r(D),l.d(D,{default:function(){return fe}});var C=l(40807),j=l(78210),g=l(67294),f=l(54707),N=l(48187),e=l(85893);function Y(s){var n=s.schema,o=s.index,a=s.seqNo,r=(0,f.AK)("-body-questionSet"),c=(0,g.useContext)(C.ZX),v=c.questionNumber;return(0,e.jsxs)("div",{className:r,children:[(0,e.jsxs)("div",{className:r+"-title",children:[v?a||"".concat(o+1,"."):"",(0,e.jsx)(j.Z,{html:n.title})]}),s.children,(0,e.jsx)("div",{className:r+"-splitLine"})]})}(0,N.eC)("QuestionSet",Y,"antdForm");var Ce=l(9715),Q=l(55843),M=l(94657),B=l(9761),X=function(){var n=(0,f.AK)(),o=(0,g.useContext)(C.ZX),a=o.schema;return(0,e.jsxs)("div",{className:n+"-header",children:[(0,e.jsx)("div",{className:n+"-header-title",children:(0,e.jsx)(j.Z,{html:a.title})}),(0,e.jsx)("div",{className:n+"-header-description",children:(0,e.jsx)(j.Z,{html:a.description})})]})},k=function(n){var o=(0,f.AK)();return(0,e.jsx)("div",{className:o+"-body",children:n.children})},Ne=l(57663),A=l(71577),U=(0,B.Pi)(function(){var s,n,o=(0,f.AK)("-footer"),a=(0,g.useContext)(C.ZX),r=a.schema,c=a.loading,v=(0,f.Rk)(),d=v.pagination,t=d.pageSize>1,i=d.current===1,u=d.current===d.pageSize;return(0,e.jsxs)("div",{className:o,children:[u&&(0,e.jsx)("div",{className:o+"-desc",style:{userSelect:"none"},children:(0,e.jsx)(j.Z,{html:r==null||(s=r.attribute)===null||s===void 0?void 0:s.suffix})}),(0,e.jsxs)("div",{className:o+"-pagination",children:[t&&!i&&(0,e.jsx)("div",{children:(0,e.jsx)(A.Z,{type:"primary",block:!0,onClick:function(){return v.handlePrev()},children:"\u4E0A\u4E00\u9875"})}),t&&!u&&(0,e.jsx)("div",{children:(0,e.jsx)(A.Z,{type:"primary",block:!0,onClick:function(){return v.handleNext()},children:"\u4E0B\u4E00\u9875"})}),u&&(0,e.jsx)("div",{children:(0,e.jsx)(A.Z,{type:"primary",block:!0,onClick:function(){return v.submit()},loading:c,children:(0,e.jsx)(j.Z,{html:((n=r.attribute)===null||n===void 0?void 0:n.submitButton)||"\u63D0\u4EA4"})})}),t&&(0,e.jsxs)("div",{className:o+"-pagination-info",children:["\u7B2C",d.current,"\u9875/\u5171",d.pageSize,"\u9875"]})]})]})}),Fe=l(47673),F=l(4107),Se=l(39002),$=l(68351),Ze=l(14965),P=l(68318),Be=l(77883),W=l(85986),G=l(29985),J=l(46842),O=l(64302),w=l(27484),S=l.n(w),Ae=l(33852);S().locale("zh-cn");var q="YYYY-MM-DD",_="YYYY-MM-DD HH:mm:ss",ee="HH:mm:ss";function p(s,n){if(!!s){if(n==="date")return S()(s,q);if(n==="dateTime")return S()(s,_);if(n==="time")return S()(s,ee)}}var ne=function(n){var o=n.onChange,a=n.type,r=n.value,c=n.suffix,v=n.style,d=v===void 0?{width:"100%"}:v;return a==="number"?(0,e.jsx)(W.Z,{onChange:o,value:r,style:d,addonAfter:c}):a==="date"?(0,e.jsx)(P.Z,{onChange:function(i,u){o(u)},value:p(r,a),style:d}):a==="dateTime"?(0,e.jsx)(P.Z,{showTime:!0,onChange:function(i,u){return o(u)},value:p(r,a),style:d}):a==="time"?(0,e.jsx)($.Z,{value:p(r,a),onChange:function(i,u){return o(u)},style:d}):a==="mobile"?(0,e.jsx)(F.Z,{prefix:(0,e.jsx)(G.Z,{}),onChange:function(i){return o(i.target.value)},value:r}):a==="idCard"?(0,e.jsx)(F.Z,{prefix:(0,e.jsx)(J.Z,{}),onChange:function(i){return o(i.target.value)},value:r,style:d}):a==="email"?(0,e.jsx)(F.Z,{prefix:(0,e.jsx)(O.Z,{}),onChange:function(i){return o(i.target.value)},value:r,style:d}):a==="password"?(0,e.jsx)(F.Z.Password,{placeholder:"\u8BF7\u8F93\u5165\u5BC6\u7801",onChange:function(i){return o(i.target.value)},value:r,suffix:c,style:d}):(0,e.jsx)(F.Z,{onChange:function(i){return o(i.target.value)},value:r,suffix:c,style:d})},pe=l(49111),be=function(n){var o=n.onChange,a=useRef(null),r=useRef(),c=useRef(),v=useState(0),d=_slicedToArray(v,2),t=d[0],i=d[1];return useEffect(function(){var u=a.current;if(u){var h,x=new SignaturePad(a.current);x.addEventListener("beginStroke",function(){i(1)}),r.current=x;var m=Math.max(window.devicePixelRatio||1,1);u.width=u.offsetWidth*m,u.height=u.offsetHeight*m,(h=u.getContext("2d"))===null||h===void 0||h.scale(m,m)}},[]),_jsxs("div",{className:"signature-pad",children:[_jsx("span",{style:{position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)",color:"#aaa",visibility:c.current?"hidden":"visible"},children:"\u70B9\u51FB\u7B7E\u540D"}),_jsxs("div",{className:"signature",children:[_jsx("canvas",{ref:a,style:{width:"100%",height:"100%",touchAction:"none",userSelect:"none",display:t!==2?"block":"none"}}),t===2&&_jsx("img",{src:c.current||void 0})]}),_jsxs("div",{className:"save-signature",children:[_jsx("span",{children:"\u7B7E\u540D\u5B8C\u6210\u540E\uFF0C\u8BF7\u70B9\u51FB\u3010\u5B8C\u6210\u3011\u6309\u94AE"}),_jsx("div",{children:_jsxs(_Space,{children:[t===1&&_jsx(_Button,{type:"link",onClick:function(){var h;(h=r.current)===null||h===void 0||h.clear(),i(0)},children:"\u6E05\u7A7A"}),(t===0||t===1)&&_jsx(_Button,{type:"primary",disabled:t!==1,ghost:!0,size:"small",onClick:function(){var h;o(r.current.toDataURL()),c.current=(h=r.current)===null||h===void 0?void 0:h.toDataURL(),i(2)},children:"\u5B8C\u6210"}),t===2&&_jsx(_Button,{type:"primary",ghost:!0,size:"small",onClick:function(){var h;i(0),(h=r.current)===null||h===void 0||h.clear()},children:"\u91CD\u7B7E"})]})})]})]})},te=l(3024),re=(0,B.Pi)(function(){var s=(0,g.useContext)(C.ZX),n=s.progressBar,o=(0,f.AK)(),a=(0,f.Rk)(),r=a.progress;return n?(0,e.jsx)(te.Z,{enabled:!0,top:0,innerActiveClass:"fixed",children:(0,e.jsx)("div",{className:o+"-progress",children:(0,e.jsx)("div",{className:"progress-bar s-prog-wait",children:(0,e.jsx)("div",{className:"progress-done  s-prog-done",style:{width:"".concat(r*100,"%")}})})})}):(0,e.jsx)(e.Fragment,{})}),Ee=function(n){var o,a=n.optionId,r=n.questionId,c=n.checked,v=n.checkedCount,d=useSurvey(),t=d.statistics,i=t==null?void 0:t.questionStatistics[r],u=((i==null?void 0:i.optionStatistics.reduce(function(m,y){return m+y.count},0))||0)+v,h=(i==null||(o=i.optionStatistics.find(function(m){return m.optionId===a}))===null||o===void 0?void 0:o.count)||0;h=c?h+1:h;var x="".concat(Math.floor(h/u*1e3)/10,"%");return v===0?_jsx(_Fragment,{}):_jsxs("span",{className:"vote-info",children:[_jsxs("span",{className:"vote-info-cnt ",children:[h,"\u7968"]}),_jsx("span",{className:"vote-info-percent ",children:x}),_jsx("div",{className:"vote-info-bar",children:_jsx("div",{className:"vote-info-bar-fill",style:{width:x}})})]})},ae=function(n){var o=n.schema,a=n.type,r=o.attribute,c=r===void 0?{}:r,v=c.examCorrectAnswer,d=(0,f.Al)(),t=d.correctAnswerVisible,i=d.mode;return v&&t&&i==="exam"?a==="FillBlank"||a==="HorzBlank"||a==="MultipleBlank"?(0,e.jsx)("span",{className:"correct-answer",children:v}):(0,e.jsx)("span",{className:"correct-answer",children:"\uFF08\u6B63\u786E\u7B54\u6848\uFF09"}):(0,e.jsx)(e.Fragment,{})},se=function(n){var o=n.schema,a=o.attribute,r=a===void 0?{}:a,c=r.examScore,v=(0,f.Al)(),d=v.mode,t=v.examScoreVisible;return c&&d==="exam"&&t?(0,e.jsxs)("span",{className:"question-score",children:["\uFF08",c,"\u5206\uFF09"]}):(0,e.jsx)(e.Fragment,{})};function ie(s){var n=s.schema,o=s.index,a=s.qsIndex,r=s.required,c=s.error,v=s.replaceTitle,d=s.seqNo,t=(0,g.useContext)(C.ZX),i=t.questionNumber,u=(0,f.AK)("-body-question"),h=(0,g.useState)(),x=(0,M.Z)(h,2),m=x[0],y=x[1],V=(0,f.Rk)();(0,g.useEffect)(function(){if(m){var Z,E;(Z=document.querySelector("[data-id='".concat(n.id,"']")))===null||Z===void 0||Z.classList.remove("ant-form-item-has-error"),(E=document.querySelector("[data-id='".concat(n.id,"']")))===null||E===void 0||E.querySelectorAll("[data-id]").forEach(function(ge){ge.classList.remove("ant-form-item-has-error")})}if(c.length>0){var I,je=c[0].split("^"),z=(0,M.Z)(je,2),K=z[0],L=z[1],R;L?(R=document.querySelector("[data-id='".concat(K,"']")),y(L)):(R=document.querySelector("[data-id='".concat(n.id,"']")),y(K)),(I=R)===null||I===void 0||I.classList.add("ant-form-item-has-error")}else m&&y(void 0)},[c]);var b="";a!==void 0&&(b+=a+1+"-"),o!==void 0&&(b+=o+1+".");var xe=function(){return m?(0,e.jsx)("span",{className:"question-tag error animated",children:(0,e.jsx)("span",{children:m})}):(0,e.jsx)(e.Fragment,{})};return(0,e.jsx)("div",{className:u,children:(0,e.jsx)(Q.Z.Item,{label:(0,e.jsxs)("span",{className:u+"-header",children:[i?d||b:"",(0,e.jsx)(j.Z,{html:v||n.title}),(0,e.jsx)(se,{schema:n}),xe()]}),labelCol:{span:24},wrapperCol:{span:24},required:r,children:s.children})})}(0,N.eC)("Question",(0,B.Pi)(ie),"antdForm");var Ie=l(84305),le=l(88182),oe=l(82925),ue=l(94184),de=l.n(ue);S().locale("zh-cn");function ce(s){var n=s.headerVisible,o=s.footerVisible,a=s.schema,r=(0,f.AK)(),c=(0,f.Al)(),v=function(){var t,i=(t=a.attribute)===null||t===void 0?void 0:t.headerImage;if(i)return(0,e.jsx)("img",{src:"/api/public/preview/".concat(i),style:{maxWidth:"100%"}})};return(0,e.jsxs)("div",{className:de()(r,{preview:c.isPreview}),children:[(0,e.jsx)(re,{}),(0,e.jsx)("div",{className:r+"-banner",children:v()}),n&&(0,e.jsx)(X,{}),(0,e.jsx)(le.ZP,{locale:oe.Z,children:(0,e.jsx)(k,{children:s.children})}),o&&(0,e.jsx)(U,{})]})}(0,N.eC)("Survey",ce,"antdForm");var Re=l(13062),ve=l(71230),De=l(89032),T=l(15746),he=l(11849);function H(s){var n=s.schema,o=s.onChange,a=s.value,r=a===void 0?{}:a,c=n.children,v=(0,f.AK)("-body-question");function d(t,i){r[t]=i,i===""&&delete r[t],o((0,he.Z)({},r))}return(0,e.jsx)("div",{children:c==null?void 0:c.map(function(t){var i=t.id,u=t.attribute,h=t.title,x=u==null?void 0:u.suffix,m=u==null?void 0:u.dataType;return(0,e.jsxs)(ve.Z,{style:{marginBottom:10},"data-id":i,children:[h&&(0,e.jsx)(T.Z,{className:v+"-option",span:4,children:t.title&&(0,e.jsx)("span",{className:v+"-option-title",children:(0,e.jsx)(j.Z,{html:t.title})})},t.id),(0,e.jsxs)(T.Z,{span:24,children:[(0,e.jsx)(ne,{type:m,value:r[i],onChange:function(V){return d(i,V)},suffix:x&&(0,e.jsx)("span",{className:v+"-option-suffix",children:(0,e.jsx)(j.Z,{html:x})})}),(0,e.jsx)(ae,{schema:t,type:n.type})]})]},i)})})}(0,N.RM)("FillBlank",H,"antdForm"),(0,N.RM)("MultipleBlank",H,"antdForm");var me=function(n){return(0,e.jsx)(e.Fragment,{children:n.children})},fe=me}}]);
