(self.webpackChunksurvey_king=self.webpackChunksurvey_king||[]).push([[6527],{46502:function(E){E.exports={baseView:"baseView___3sRG3",left:"left___GavW0",right:"right___3-EXe",avatar_title:"avatar_title___13ztg",avatar:"avatar___1GisI",button_view:"button_view___o9apF",area_code:"area_code___3Tg4d",phone_number:"phone_number___1bV0u"}},41215:function(E){E.exports={main:"main___2yGev",leftMenu:"leftMenu___179-W",right:"right___2jdGg",title:"title___3cGwa"}},41794:function(E,A,r){"use strict";r.r(A),r.d(A,{default:function(){return le}});var oe=r(30887),K=r(28682),g=r(11849),M=r(94657),C=r(67294),$=r(25130),ce=r(34792),I=r(48086),de=r(43185),R=r(32620),ve=r(57663),D=r(71577),m=r(39428),P=r(3182),G=r(84391),U=r(75291),j=r(5966),T=r(90672),L=r(3297),p=r(3980),w=r(27400),S=r(9761),O=r(46502),h=r.n(O),W=r(5481),z=r.n(W),e=r(85893),X=(0,S.Pi)(function(){var Z=(0,w.a)(),s=Z.user,d=function(){var v=(0,P.Z)((0,m.Z)().mark(function t(o){var l,c,i,u;return(0,m.Z)().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:l=o.onSuccess,c=o.onError,i=o.file,u=o.onProgress,p.hi.upload("/api/public/upload",{file:i},function(a){u&&u({percent:a.loaded/a.total*100})}).then(function(a){if(a.success&&l&&(l(a.data),p.hi.updateUserInfo({avatar:a.data.id}).then(function(y){y.success&&(s.avatar=a.data.id)})),!a.success&&c){var x=new Error("Some error");c({event:x})}});case 2:case"end":return n.stop()}},t)}));return function(o){return v.apply(this,arguments)}}();return(0,e.jsxs)(e.Fragment,{children:[(0,e.jsx)("div",{className:h().avatar_title,children:"\u5934\u50CF"}),(0,e.jsx)("div",{className:h().avatar,children:s!=null&&s.avatar?(0,e.jsx)("img",{style:{borderRadius:"50%"},src:"/api/public/preview/".concat(s==null?void 0:s.avatar),alt:"avatar"}):(0,e.jsx)("img",{style:{borderRadius:"50%"},src:z(),alt:"avatar"})}),(0,e.jsx)(L.Z,{rotate:!0,shape:"round",cropperProps:{},children:(0,e.jsx)(R.Z,{showUploadList:!1,customRequest:d,children:(0,e.jsx)("div",{className:h().button_view,children:(0,e.jsxs)(D.Z,{children:[(0,e.jsx)(G.Z,{}),"\u66F4\u6362\u5934\u50CF"]})})})})]})}),Y=function(){var s=(0,w.a)(),d=s.user,v=s.loading,t=(0,C.useMemo)(function(){return d},[]),o=function(){var l=(0,P.Z)((0,m.Z)().mark(function c(i){return(0,m.Z)().wrap(function(f){for(;;)switch(f.prev=f.next){case 0:p.hi.updateUserInfo(i).then(function(n){n.success&&(s.user=(0,g.Z)((0,g.Z)({},d),i),I.default.success("\u66F4\u65B0\u57FA\u672C\u4FE1\u606F\u6210\u529F"))});case 1:case"end":return f.stop()}},c)}));return function(i){return l.apply(this,arguments)}}();return(0,e.jsx)("div",{className:h().baseView,children:v?null:(0,e.jsxs)(e.Fragment,{children:[(0,e.jsx)("div",{className:h().left,children:(0,e.jsxs)(U.ZP,{layout:"vertical",onFinish:o,submitter:{resetButtonProps:{style:{display:"none"}},submitButtonProps:{children:"\u66F4\u65B0\u57FA\u672C\u4FE1\u606F"}},initialValues:t,hideRequiredMark:!0,children:[(0,e.jsx)(j.Z,{width:"md",name:"name",label:"\u59D3\u540D",rules:[{required:!0,message:"\u8BF7\u8F93\u5165\u60A8\u7684\u6635\u79F0!"}]}),(0,e.jsx)(j.Z,{name:"phone",label:"\u624B\u673A\u53F7",rules:[{required:!0,message:"\u8BF7\u8F93\u5165\u60A8\u7684\u8054\u7CFB\u7535\u8BDD!"}]}),(0,e.jsx)(j.Z,{width:"md",name:"email",label:"\u90AE\u7BB1",rules:[{required:!0,message:"\u8BF7\u8F93\u5165\u60A8\u7684\u90AE\u7BB1!"}]}),(0,e.jsx)(T.Z,{name:"profile",label:"\u4E2A\u4EBA\u7B80\u4ECB",rules:[{required:!0,message:"\u8BF7\u8F93\u5165\u4E2A\u4EBA\u7B80\u4ECB!"}],placeholder:"\u4E2A\u4EBA\u7B80\u4ECB"})]})}),(0,e.jsx)("div",{className:h().right,children:(0,e.jsx)(X,{})})]})})},H=(0,S.Pi)(Y),fe=r(54421),B=r(38272),me=r(77576),J=r(12028),Q=function(){var s=function(){var t=(0,e.jsx)(J.Z,{checkedChildren:"\u5F00",unCheckedChildren:"\u5173",defaultChecked:!0});return[{title:"\u8D26\u6237\u5BC6\u7801",description:"\u5176\u4ED6\u7528\u6237\u7684\u6D88\u606F\u5C06\u4EE5\u7AD9\u5185\u4FE1\u7684\u5F62\u5F0F\u901A\u77E5",actions:[t]},{title:"\u7CFB\u7EDF\u6D88\u606F",description:"\u7CFB\u7EDF\u6D88\u606F\u5C06\u4EE5\u7AD9\u5185\u4FE1\u7684\u5F62\u5F0F\u901A\u77E5",actions:[t]},{title:"\u5F85\u529E\u4EFB\u52A1",description:"\u5F85\u529E\u4EFB\u52A1\u5C06\u4EE5\u7AD9\u5185\u4FE1\u7684\u5F62\u5F0F\u901A\u77E5",actions:[t]}]},d=s();return(0,e.jsx)(C.Fragment,{children:(0,e.jsx)(B.ZP,{itemLayout:"horizontal",dataSource:d,renderItem:function(t){return(0,e.jsx)(B.ZP.Item,{actions:t.actions,children:(0,e.jsx)(B.ZP.Item.Meta,{title:t.title,description:t.description})})}})})},k=Q,q=r(37476),_=function(){var s=(0,C.useState)(!1),d=(0,M.Z)(s,2),v=d[0],t=d[1],o=(0,w.a)(),l=o.user,c=(0,p.m2)(),i=(0,C.useRef)(),u=function(){return[{title:"\u8D26\u6237\u5BC6\u7801",actions:[(0,e.jsx)("a",{onClick:function(){return t(!0)},children:"\u4FEE\u6539"},"Modify")]}]},f=u();return(0,e.jsxs)(e.Fragment,{children:[(0,e.jsx)(B.ZP,{itemLayout:"horizontal",dataSource:f,renderItem:function(a){return(0,e.jsx)(B.ZP.Item,{actions:a.actions,children:(0,e.jsx)(B.ZP.Item.Meta,{title:a.title})})}}),(0,e.jsxs)(q.Y,{title:"\u4FEE\u6539\u5BC6\u7801",visible:v,formRef:i,width:400,modalProps:{onCancel:function(){t(!1)},okText:"\u786E\u8BA4\u4FEE\u6539",maskClosable:!1},onFinish:function(){var n=(0,P.Z)((0,m.Z)().mark(function a(x){return(0,m.Z)().wrap(function(F){for(;;)switch(F.prev=F.next){case 0:c.saveOrUpdateUser((0,g.Z)({id:l==null?void 0:l.userId},x)).then(function(b){b.success?(t(!1),I.default.success("\u5BC6\u7801\u4FEE\u6539\u6210\u529F")):I.default.error(b.message)});case 1:case"end":return F.stop()}},a)}));return function(a){return n.apply(this,arguments)}}(),children:[(0,e.jsx)(j.Z.Password,{label:"\u65E7\u5BC6\u7801",name:"oldPassword",fieldProps:{size:"large"},placeholder:"\u8BF7\u8F93\u5165\u5F53\u524D\u767B\u5F55\u5BC6\u7801",rules:[{required:!0,message:"\u8BF7\u8F93\u5165\u5BC6\u7801\uFF01"}]}),(0,e.jsx)(j.Z.Password,{name:"password",label:"\u65B0\u5BC6\u7801",fieldProps:{size:"large"},placeholder:"\u8BF7\u8F93\u5165\u5BC6\u7801",rules:[{required:!0,message:"\u8BF7\u8F93\u5165\u5BC6\u7801\uFF01"}]}),(0,e.jsx)(j.Z.Password,{name:"confirmPassword",label:"\u786E\u8BA4\u5BC6\u7801",fieldProps:{size:"large"},placeholder:"\u8BF7\u518D\u6B21\u8F93\u5165\u5BC6\u7801",rules:[{validator:function(a,x){var y,F,b=(y=i.current)===null||y===void 0?void 0:y.getFieldValue("password");return x?b!==x&&(F="\u4E24\u6B21\u5BC6\u7801\u8F93\u5165\u4E0D\u4E00\u81F4"):F="\u8BF7\u518D\u6B21\u8F93\u5165\u5BC6\u7801",F?Promise.reject(new Error(F)):Promise.resolve()}}]})]})]})},ee=(0,S.Pi)(_),N=r(52688),ae=r(97462),re=r(64317),se=(0,S.Pi)(function(){var Z=(0,w.a)(),s=Z.system,d=function(){var v=(0,P.Z)((0,m.Z)().mark(function t(o){var l,c,i,u;return(0,m.Z)().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:l=o.onSuccess,c=o.onError,i=o.file,u=o.onProgress,p.hi.upload("/api/public/upload",{file:i},function(a){u&&u({percent:a.loaded/a.total*100})}).then(function(a){if(a.success&&l&&(l(a.data),p.hi.updateSysInfo({id:s==null?void 0:s.id,avatar:a.data.id}).then(function(y){y.success&&(s.avatar=a.data.id)})),!a.success&&c){var x=new Error("Some error");c({event:x})}});case 2:case"end":return n.stop()}},t)}));return function(o){return v.apply(this,arguments)}}();return(0,e.jsxs)(e.Fragment,{children:[(0,e.jsx)("div",{className:h().avatar_title,children:"\u7CFB\u7EDF\u56FE\u6807"}),(0,e.jsx)("div",{className:h().avatar,children:s.avatar?(0,e.jsx)("img",{src:"/api/public/preview/".concat(s==null?void 0:s.avatar),alt:"avatar"}):(0,e.jsx)("img",{src:z()})}),(0,e.jsx)(R.Z,{showUploadList:!1,customRequest:d,children:(0,e.jsx)("div",{className:h().button_view,children:(0,e.jsxs)(D.Z,{children:[(0,e.jsx)(G.Z,{}),"\u66F4\u6362\u56FE\u6807"]})})})]})}),te=function(){var s=(0,w.a)(),d=s.system,v=s.loading,t=(0,p.m2)(),o=t.roles;(0,C.useEffect)(function(){t.loadRoles({current:1,pageSize:1024})},[t]);var l=function(){var c=(0,P.Z)((0,m.Z)().mark(function i(u){return(0,m.Z)().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",p.hi.updateSysInfo((0,g.Z)((0,g.Z)({},d),u)).then(function(a){a.success&&(s.system=(0,g.Z)((0,g.Z)((0,g.Z)({},d),u),{},{avatar:d.avatar}),I.default.success("\u66F4\u65B0\u57FA\u672C\u4FE1\u606F\u6210\u529F"))}));case 1:case"end":return n.stop()}},i)}));return function(u){return c.apply(this,arguments)}}();return(0,e.jsx)("div",{className:h().baseView,children:v?null:(0,e.jsxs)(e.Fragment,{children:[(0,e.jsx)("div",{className:h().left,children:(0,e.jsxs)(U.ZP,{initialValues:d,onFinish:function(){var c=(0,P.Z)((0,m.Z)().mark(function i(u){var f;return(0,m.Z)().wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,l(u);case 2:f=a.sent;case 3:case"end":return a.stop()}},i)}));return function(i){return c.apply(this,arguments)}}(),children:[(0,e.jsx)(j.Z,{width:"md",name:"name",label:(0,e.jsxs)("span",{children:["\u7CFB\u7EDF\u540D\u79F0(",(0,e.jsx)("a",{href:"https://surveyking.cn/open-source/changelog",target:"_blank",children:"\u7248\u672C\u53F7v1.7.0"}),")"]}),required:!0,rules:[{required:!0,message:"\u7CFB\u7EDF\u540D\u79F0\u4E0D\u80FD\u4E3A\u7A7A"}]}),(0,e.jsx)(j.Z,{name:"description",label:"\u63CF\u8FF0\u4FE1\u606F"}),(0,e.jsx)(j.Z,{name:["setting","copyright"],label:"\u7248\u6743\u4FE1\u606F"}),(0,e.jsx)(j.Z,{name:["setting","recordNum"],label:"\u5907\u6848\u53F7"}),(0,e.jsx)(N.Z,{name:["registerInfo","registerEnabled"],label:"\u5F00\u542F\u6CE8\u518C"}),(0,e.jsx)(ae.Z,{name:[["registerInfo","registerEnabled"]],children:function(i){var u=i.registerInfo;return u!=null&&u.registerEnabled?(0,e.jsxs)(e.Fragment,{children:[(0,e.jsx)(re.Z,{mode:"multiple",options:o.map(function(f){return{label:f.name,value:f.id}}),width:"md",name:["registerInfo","roles"],label:"\u6CE8\u518C\u7528\u6237\u53EF\u9009\u62E9\u89D2\u8272\u5217\u8868"}),(0,e.jsx)(N.Z,{name:["registerInfo","strongPasswordEnabled"],label:"\u5F00\u542F\u5F3A\u5BC6\u7801\u9A8C\u8BC1"})]}):(0,e.jsx)(e.Fragment,{})}}),(0,e.jsx)(N.Z,{name:["setting","captchaEnabled"],label:"\u5F00\u542F\u9A8C\u8BC1\u7801"})]})}),(0,e.jsx)("div",{className:h().right,children:(0,e.jsx)(se,{})})]})})},ne=(0,S.Pi)(te),ie=r(41215),V=r.n(ie),ue=function(){var s=(0,w.a)(),d=s.isAdmin,v={base:"\u57FA\u672C\u8BBE\u7F6E",security:"\u5B89\u5168\u8BBE\u7F6E",appInfo:"\u7CFB\u7EDF\u8BBE\u7F6E"},t=(0,C.useState)({mode:"inline",selectKey:"base"}),o=(0,M.Z)(t,2),l=o[0],c=o[1],i=(0,C.useRef)(),u=function(){return Object.keys(v).filter(function(a){return!(a==="appInfo"&&!d)}).map(function(a){return{label:v[a],key:a}})},f=function(){var a=l.selectKey;switch(a){case"base":return(0,e.jsx)(H,{});case"security":return(0,e.jsx)(ee,{});case"notification":return(0,e.jsx)(k,{});case"appInfo":return(0,e.jsx)(ne,{});default:return null}};return(0,e.jsx)($.f,{children:(0,e.jsxs)("div",{className:V().main,ref:function(a){a&&(i.current=a)},children:[(0,e.jsx)("div",{className:V().leftMenu,children:(0,e.jsx)(K.Z,{mode:l.mode,selectedKeys:[l.selectKey],onClick:function(a){var x=a.key;c((0,g.Z)((0,g.Z)({},l),{},{selectKey:x}))},items:u()})}),(0,e.jsxs)("div",{className:V().right,children:[(0,e.jsx)("div",{className:V().title,children:v[l.selectKey]}),f()]})]})})},le=(0,S.Pi)(ue)},5481:function(E,A,r){E.exports=r.p+"static/logo.efd90f0d.svg"}}]);
