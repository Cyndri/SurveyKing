(self.webpackChunksurvey_king=self.webpackChunksurvey_king||[]).push([[6637],{95357:function(se,U,t){"use strict";t.d(U,{Z:function(){return J}});var E=t(28991),I=t(67294),$={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M942.2 486.2C847.4 286.5 704.1 186 512 186c-192.2 0-335.4 100.5-430.2 300.3a60.3 60.3 0 000 51.5C176.6 737.5 319.9 838 512 838c192.2 0 335.4-100.5 430.2-300.3 7.7-16.2 7.7-35 0-51.5zM512 766c-161.3 0-279.4-81.8-362.7-254C232.6 339.8 350.7 258 512 258c161.3 0 279.4 81.8 362.7 254C791.5 684.2 673.4 766 512 766zm-4-430c-97.2 0-176 78.8-176 176s78.8 176 176 176 176-78.8 176-176-78.8-176-176-176zm0 288c-61.9 0-112-50.1-112-112s50.1-112 112-112 112 50.1 112 112-50.1 112-112 112z"}}]},name:"eye",theme:"outlined"},T=$,p=t(27029),k=function(g,b){return I.createElement(p.Z,(0,E.Z)((0,E.Z)({},g),{},{ref:b,icon:T}))};k.displayName="EyeOutlined";var J=I.forwardRef(k)},78210:function(se,U,t){"use strict";var E=t(12968),I=t(62462),$=t(27856),T=t.n($),p=t(15020),k=t(85893),J=function(g){var b=g.html,K=b===void 0?"":b,z=g.replaceP,ae=z===void 0?!0:z;return ae?(0,k.jsx)("div",{className:"pe-view",children:typeof K=="string"&&(0,p.ZP)(T().sanitize(K,{ADD_TAGS:["iframe"],ADD_ATTR:["allow","allowfullscreen","frameborder","scrolling"]}).replace(/<p>/,"<span>").replace(/<\/p>/,"</span>"),{replace:function(F){if((F==null?void 0:F.name)==="img"){var H=F.attribs.width;return(0,k.jsx)(I.Z,{width:H?parseFloat(H):void 0,src:F.attribs.src,style:{cursor:"zoom-in"},fallback:"data:image/png;base64,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",preview:{mask:!1}})}return F}})}):(0,k.jsx)(k.Fragment,{children:typeof K=="string"&&(0,p.ZP)(T().sanitize(K))})};U.Z=J},79662:function(se,U,t){"use strict";t.r(U),t.d(U,{MobileOrPC:function(){return de},default:function(){return Re}});var E=t(39428),I=t(3182),$=t(71194),T=t(50146),p=t(11849),k=t(68068),J=t(9761),G=t(42277),g=t(67294),b=t(51615),K=t(92725),z=t(12997),ae=t(49111),oe=t(19650),F=t(57663),H=t(71577),pe=t(94657),x=t(3980),Qe=t(27400),ye=t(73727),we=t(49914),S=t(96389),r=t(85893),Ce=(0,J.Pi)(function(){var y,o,e=(0,we.H)(),l=(0,Qe.a)(),n=e.success,u=(y=e.setting)===null||y===void 0?void 0:y.submittedSetting,f=(o=e.setting)===null||o===void 0?void 0:o.answerSetting.loginRequired,s=e.survey,A=e.id,w=(0,g.useMemo)(function(){return s?(0,S.R6)(s):{}},[s]),B=u||{},C=B.contentHtml,h=B.redirectUrl,a=B.answerAnalysis,P=B.rankVisible,O=B.transcriptVisible,Y=e.answerId,j=e.answerQrCodeUrl,V=e.answerView,c=e.values;(0,g.useEffect)(function(){if(h&&c){if(!h.includes("(")){window.location.href=h;return}var R=(0,S.vW)(h,function(Z){var _=(0,S.Op)(Z),ee=(0,pe.Z)(_,2),te=ee[0],ce=ee[1],re=c[te];return(0,S.d0)(w,re,Z)});R.success&&(window.location.href=R.result)}},[h,c]),(0,g.useEffect)(function(){n&&s&&c&&V&&(0,S.MA)(s,C,c,V.examScore)},[C,n,s,c,V]);var X=function(){var Z="";return a&&P?Z="\u67E5\u770B\u6392\u540D\u53CA\u89E3\u6790":P?Z="\u67E5\u770B\u8003\u8BD5\u6392\u540D":(a||O)&&(Z="\u67E5\u770B\u7B54\u6848\u89E3\u6790"),Z?(0,r.jsx)("div",{children:(0,r.jsx)(H.Z,{onClick:function(){return window.open("/s/".concat(A,"/exam-result/").concat(Y))},children:Z})}):(0,r.jsx)(r.Fragment,{})};return n?(0,r.jsx)("div",{className:"survey-end animated",children:(0,r.jsx)("div",{className:"survey-end-content",children:(0,r.jsx)("h3",{className:"survey-end-title ",children:(0,r.jsxs)("div",{children:[(0,r.jsx)("div",{id:"result-message"}),X(),(0,r.jsx)("div",{children:f&&(0,r.jsxs)(oe.Z,{children:[(0,r.jsx)(ye.rU,{to:"/",children:(0,r.jsx)(H.Z,{type:"link",onClick:function(){},children:"\u8FD4\u56DE\u9996\u9875"})}),(0,r.jsx)(H.Z,{type:"link",onClick:function(){l.logout(),(0,x.on)()},children:"\u9000\u51FA\u5173\u95ED"})]})})]})})})}):(0,r.jsx)(r.Fragment,{})}),Ie=Ce;function Be(y){return g.createElement("svg",Object.assign({width:"1em",height:"1em",viewBox:"0 0 48 48",xmlns:"http://www.w3.org/2000/svg",xmlnsXlink:"http://www.w3.org/1999/xlink"},y,{style:Object.assign({verticalAlign:"-0.125em"},y.style),className:["antd-mobile-icon",y.className].filter(Boolean).join(" ")}),g.createElement("g",{id:"ExclamationCircleFill-ExclamationCircleFill",stroke:"none",strokeWidth:1,fill:"none",fillRule:"evenodd"},g.createElement("g",null,g.createElement("rect",{id:"ExclamationCircleFill-\u77E9\u5F62",fill:"#D76060",opacity:0,x:0,y:0,width:48,height:48}),g.createElement("path",{d:"M24,2 C36.1502645,2 46,11.8497355 46,24 C46,36.1502645 36.1502645,46 24,46 C11.8497355,46 2,36.1502645 2,24 C2,11.8497355 11.8497355,2 24,2 Z M25.1,31 L22.9,31 C22.6790861,31 22.5,31.1790861 22.5,31.4 L22.5,31.4 L22.5,33.6 C22.5,33.8209139 22.6790861,34 22.9,34 L22.9,34 L25.1,34 C25.3209139,34 25.5,33.8209139 25.5,33.6 L25.5,33.6 L25.5,31.4 C25.5,31.1790861 25.3209139,31 25.1,31 L25.1,31 Z M25.1,14 L22.9,14 C22.6790861,14 22.5,14.1790861 22.5,14.4 L22.5,14.4 L22.5,27.6 C22.5,27.8209139 22.6790861,28 22.9,28 L22.9,28 L25.1,28 C25.3209139,28 25.5,27.8209139 25.5,27.6 L25.5,27.6 L25.5,14.4 C25.5,14.1790861 25.3209139,14 25.1,14 L25.1,14 Z",id:"ExclamationCircleFill-\u5F62\u72B6\u7ED3\u5408",fill:"currentColor",fillRule:"nonzero"}))))}var Se=Be,q=t(78210),Ke=t(34792),ue=t(48086),je=t(69610),Ze=t(54941),i=t(54531),le=t(36855),Le=t(42238),De=t.n(Le),ke=function(){function y(o){var e;(0,je.Z)(this,y),this.id=void 0,this.project=void 0,this.survey=void 0,this.loading=void 0,this.verifying=!1,this.saving=!1,this.isPC=void 0,this.errorCode=void 0,this.errorMessage=void 0,this.progress=0,this.confirmTempAnswerType=0,this.statistics=void 0,this.answerUrl=void 0,this.answerQrCodeUrl=void 0,this.loginRequired=void 0,this.whitelistName=void 0,this.success=void 0,this.answerId=void 0,this.answerView=void 0,this.values=void 0,this.openId=void 0,this.token=void 0,this.surveyRef=void 0,this.id=o.id,this.answerId=o.answerId,this.surveyRef=o.surveyRef;var l=le.parse(window.location.search);l&&(this.openId=l.openId,this.token=l["sk-token"]),this.makeObservable(),this.loadProject(),this.confirmTempAnswerType=(e=this.savedAnswer)!==null&&e!==void 0&&e.progress?1:0}return(0,Ze.Z)(y,[{key:"makeObservable",value:function(){(0,i.Ou)(this,{id:i.LO.ref,answerId:i.LO.ref,survey:i.LO.ref,loading:i.LO.ref,saving:i.LO.ref,verifying:i.LO.ref,project:i.LO.ref,errorCode:i.LO.ref,errorMessage:i.LO.ref,progress:i.LO.ref,confirmTempAnswerType:i.LO.ref,statistics:i.LO.ref,answerUrl:i.LO.ref,answerQrCodeUrl:i.LO.ref,success:i.LO.ref,answerView:i.LO.ref,values:i.LO.ref,loginRequired:i.LO.ref,whitelistName:i.LO.ref,openId:i.LO.ref,token:i.LO.ref,passwordRequired:i.LO.computed,mode:i.LO.computed,tempSaveId:i.LO.computed,status:i.LO.computed,setting:i.LO.computed,tempSave:i.aD,saveData:i.aD,loadProject:i.aD,changeProgress:i.aD,validate:i.aD})}},{key:"setting",get:function(){var e;return(e=this.project)===null||e===void 0?void 0:e.setting}},{key:"status",get:function(){var e;return(e=this.project)===null||e===void 0?void 0:e.status}},{key:"passwordRequired",get:function(){var e;return(e=this.project)===null||e===void 0?void 0:e.passwordRequired}},{key:"mode",get:function(){var e;return(e=this.project)===null||e===void 0?void 0:e.mode}},{key:"tempSaveId",get:function(){return"savedAnswer-"+this.id}},{key:"savedAnswer",get:function(){var e=localStorage.getItem(this.tempSaveId);return e&&JSON.parse(e)}},{key:"startTime",get:function(){var e,l,n;return((e=this.savedAnswer)===null||e===void 0||(l=e.metaInfo)===null||l===void 0||(n=l.answerInfo)===null||n===void 0?void 0:n.startTime)||new Date().getTime()}},{key:"tempSave",value:function(e){var l=localStorage.getItem(this.tempSaveId),n;l?(n=JSON.parse(l),n.answer=e,n.progress=this.progress):n={answer:e,metaInfo:{answerInfo:{startTime:new Date().getTime()}},progress:this.progress},localStorage.setItem(this.tempSaveId,JSON.stringify(n))}},{key:"saveData",value:function(){var o=(0,I.Z)((0,E.Z)().mark(function l(n,u){var f,s,A=this,w,B,C,h,a,P,O,Y,j;return(0,E.Z)().wrap(function(c){for(;;)switch(c.prev=c.next){case 0:if(w=u||{},B=w.answerId,C=w.forceSubmit,this.saving=!0,h=new(De())().getResult(),a={answer:n,projectId:this.id,metaInfo:{answerInfo:{startTime:this.startTime,endTime:new Date().getTime()},clientInfo:{browser:h.browser.name||"",browserVersion:h.browser.version||"",deviceType:h.device.type||"",platform:h.os.name||"",platformVersion:h.os.version||""}},id:B||this.answerId,whitelistName:this.whitelistName},P=this.startTime,O=((f=this.project)===null||f===void 0||(s=f.setting.examSetting)===null||s===void 0?void 0:s.minSubmitMinutes)||0,Y=P+O*60*1e3,!(O>0&&new Date().getTime()<Y&&C!==!0)){c.next=11;break}return ue.default.error("\u672A\u5230\u4EA4\u5377\u65F6\u95F4"),this.saving=!1,c.abrupt("return");case 11:return c.next=13,x.hi.post(this.getUrlWithToken("/api/public/saveAnswer"),a);case 13:return j=c.sent,(0,i.aD)(function(){j.success&&(j.data.answerId?A.answerId=j.data.answerId:j.data.examScore!==void 0,A.answerView=j.data,A.values=n,A.success=!0,localStorage.removeItem(A.tempSaveId)),A.saving=!1}),c.abrupt("return",j);case 16:case"end":return c.stop()}},l,this)}));function e(l,n){return o.apply(this,arguments)}return e}()},{key:"loadStatistics",value:function(){var o=(0,I.Z)((0,E.Z)().mark(function l(){var n=this,u;return(0,E.Z)().wrap(function(s){for(;;)switch(s.prev=s.next){case 0:if(!this.loading){s.next=2;break}return s.abrupt("return");case 2:return this.loading=!0,s.next=5,x.hi.post(this.getUrlWithToken("/api/public/statistics"),{id:this.id});case 5:u=s.sent,(0,i.aD)(function(){u.success&&(n.statistics=u.data),n.loading=!1});case 7:case"end":return s.stop()}},l,this)}));function e(){return o.apply(this,arguments)}return e}()},{key:"loadProject",value:function(){var o=(0,I.Z)((0,E.Z)().mark(function l(){var n=this,u;return(0,E.Z)().wrap(function(s){for(;;)switch(s.prev=s.next){case 0:return this.loading=!0,s.next=3,x.hi.post(this.getUrlWithToken("/api/public/loadProject"),{id:this.id,answerId:this.answerId});case 3:u=s.sent,(0,i.aD)(function(){u.success?(n.project=u.data,n.loginRequired=u.data.loginRequired,n.survey=u.data.survey,n.values=u.data.answer,u.data.answerId&&(n.answerId=u.data.answerId)):n.errorMessage=u.message,n.errorCode=u.code,n.loading=!1});case 5:case"end":return s.stop()}},l,this)}));function e(){return o.apply(this,arguments)}return e}()},{key:"validate",value:function(){var o=(0,I.Z)((0,E.Z)().mark(function l(n){var u=this,f;return(0,E.Z)().wrap(function(A){for(;;)switch(A.prev=A.next){case 0:return this.verifying=!0,A.next=3,x.hi.post(this.getUrlWithToken("/api/public/validateProject"),{id:this.id,answer:n,answerId:this.answerId});case 3:f=A.sent,(0,i.aD)(function(){if(f.success){var w;u.project=f.data,u.loginRequired=!1,u.survey=f.data.survey,u.whitelistName=(w=n.whitelistName)===null||w===void 0?void 0:w.whitelistName}else ue.default.error(f.message);u.verifying=!1});case 5:case"end":return A.stop()}},l,this)}));function e(l){return o.apply(this,arguments)}return e}()},{key:"upload",value:function(){var o=(0,I.Z)((0,E.Z)().mark(function l(n,u){return(0,E.Z)().wrap(function(s){for(;;)switch(s.prev=s.next){case 0:return s.abrupt("return",x.hi.upload("/api/public/upload",(0,p.Z)({fileType:4,basePath:this.id},n),u));case 1:case"end":return s.stop()}},l,this)}));function e(l,n){return o.apply(this,arguments)}return e}()},{key:"changeProgress",value:function(e){this.progress=e}},{key:"getUrlWithToken",value:function(e){return le.stringifyUrl({url:e,query:{"sk-token":this.token}})}}]),y}(),de=(0,J.Pi)(function(){var y,o,e,l,n=(0,b.UO)(),u=n.id,f=n.answerId,s=(0,b.TH)(),A=s.query.preview==="1",w=s.query.pattern,B=s.query.openid,C=(0,g.useMemo)(function(){return(0,S.SB)()},[]),h=(0,g.useRef)(null),a=(0,g.useMemo)(function(){return new ke({surveyRef:h,id:u,answerId:f})},[h,u,f]),P=a.saving,O=a.loading,Y=(y=a.setting)===null||y===void 0?void 0:y.answerSetting,j=a.loginRequired,V=a.verifying,c=Y||{},X=c.autoSave,R=c.progressBar,Z=c.initialValues,_=c.questionNumber,ee=c.wechatOnly,te=c.onePageOneQuestion,ce=c.answerSheetVisible,re=c.triggerType,Te=c.copyEnabled,ve=((o=a.setting)===null||o===void 0?void 0:o.examSetting)||{},xe=ve.exerciseMode,M=ve.maxSwitchScreenTimes,Oe=!!((e=a.setting)!==null&&e!==void 0&&(l=e.examSetting)!==null&&l!==void 0&&l.randomSurveyWrong),Ne=a.errorMessage,ne=a.savedAnswer,ge=a.confirmTempAnswerType,be=a.statistics,W=a.survey,Ae=a.answerId,he=a.mode,fe=a.success,me=(0,S.XO)(W,s);(0,g.useEffect)(function(){W&&(0,S.iq)(W,"statEnabled","quota")&&a.loadStatistics()},[W,a]);var Fe=(0,g.useCallback)(function(L,m){R&&a.changeProgress(m),X&&L&&a.tempSave(L)},[R]),Pe=function(){return(0,r.jsx)(z.BW,{})};(0,g.useEffect)(function(){if(M!==void 0){var L=!1;window.onfocus=function(){L=!0},window.onblur=function(){if(!!L){var m="ebt-".concat(u),v=parseInt(localStorage.getItem(m)||"0")+1;if(v>M){var d,N=(d=h.current)===null||d===void 0?void 0:d.getValues();a.saveData((0,p.Z)((0,p.Z)({},N),{},{openid:B}),{forceSubmit:!0}).then(function(Q){Q!=null&&Q.success&&localStorage.removeItem(m),!(Q!=null&&Q.success)&&Q!==null&&Q!==void 0&&Q.message&&(C?G.u_.alert({title:"\u4FDD\u5B58\u5931\u8D25",content:(0,r.jsx)(q.Z,{html:Q.message})}):T.Z.error({title:"\u4FDD\u5B58\u5931\u8D25",content:(0,r.jsx)(q.Z,{html:Q.message}),okText:"\u77E5\u9053\u4E86"}))});return}console.log("lose focus ".concat(v)),C?G.u_.alert({header:(0,r.jsx)(Se,{style:{fontSize:64,color:"var(--adm-color-warning)"}}),title:"\u6CE8\u610F",content:(0,r.jsx)(r.Fragment,{children:(0,r.jsxs)("div",{children:["\u6700\u591A\u53EF\u4EE5\u5207\u5C4F ",M," \u6B21\uFF0C\u68C0\u6D4B\u5230\u4F60\u5DF2\u5207\u6362\u4E86 ",v," \u6B21\uFF0C\u8D85\u8FC7",M," \u6B21\u95EE\u5377\u5C06\u5F3A\u5236\u63D0\u4EA4\u3002"]})})}):T.Z.warning({title:"\u63D0\u793A",content:"\u6700\u591A\u53EF\u4EE5\u5207\u5C4F ".concat(M," \u6B21\uFF0C\u68C0\u6D4B\u5230\u4F60\u5DF2\u5207\u6362\u4E86 ").concat(v," \u6B21\uFF0C\u8D85\u8FC7 ").concat(M," \u6B21\u95EE\u5377\u5C06\u5F3A\u5236\u63D0\u4EA4\u3002"),okText:"\u6211\u77E5\u9053\u4E86"}),localStorage.setItem(m,"".concat(v))}}}},[M]);var Ee=function(m){var v,d;return(0,r.jsxs)("div",{className:"render-failure ".concat(C?"mobile":"phone"),children:[((v=a.project)===null||v===void 0?void 0:v.name)&&(0,r.jsx)("div",{className:"title",children:(d=a.project)===null||d===void 0?void 0:d.name}),(0,r.jsxs)("div",{className:"content",children:[(0,r.jsx)("div",{children:(0,r.jsx)(z.AT,{})}),(0,r.jsx)("h2",{children:Ne||m}),(0,r.jsx)("div",{children:"\u611F\u8C22\u5173\u6CE8\uFF01"})]})]})},Me=function(){if(fe)return(0,r.jsx)(r.Fragment,{});if(O)return(0,r.jsx)(K.Z,{});if(a.errorCode!==200)return Ee();if(ee&&!(0,S.CL)())return Ee("\u53EA\u80FD\u5728\u5FAE\u4FE1\u4E2D\u6253\u5F00");if(j)return(0,r.jsx)("div",{children:Pe()});if(W&&!fe&&!V)return ge===1&&X&&he==="survey"&&!Ae?(0,r.jsx)(z.oq,{}):(0,r.jsx)("div",{style:{userSelect:Te===!1?"none":"unset"},children:(0,r.jsx)(k.Z,{ref:h,mode:he,loading:P||O,progressBar:R,questionNumber:_,theme:C?"antdMobile":"antd",schema:W,onChange:Fe,onePageOneQuestion:te,answerSheetVisible:ce,exerciseMode:xe,wrongMode:Oe,pattern:w,triggerType:re,onInit:function(v){a.tempSave(v.values)},onDictSearch:function(){var m=(0,I.Z)((0,E.Z)().mark(function v(d){var N;return(0,E.Z)().wrap(function(D){for(;;)switch(D.prev=D.next){case 0:return D.next=2,x.hi.loadDict(d);case 2:if(N=D.sent,!N.success){D.next=5;break}return D.abrupt("return",N.data);case 5:return D.abrupt("return",[]);case 6:case"end":return D.stop()}},v)}));return function(v){return m.apply(this,arguments)}}(),initialValues:ge===3?me:(0,p.Z)((0,p.Z)((0,p.Z)((0,p.Z)({},Z),X?ne==null?void 0:ne.answer:{}),me),a.values),statistics:be,onUpload:function(v,d){return a.upload(v,d)},footerVisible:!(A||w==="readPretty"),headerVisible:!A,isPreview:A,onLink:function(v){x.hi.loadLinkResult((0,p.Z)((0,p.Z)({},v),{},{projectId:u})).then(function(d){if(d.success&&d.data.answer){var N=d.data.answer;Object.keys(N).forEach(function(Q){var D=N[Q];if(v.questionId!==Q){var ie;(ie=h.current)===null||ie===void 0||ie.setValue(Q,D)}})}})},onSubmit:function(v){a.saveData((0,p.Z)((0,p.Z)({},v),{},{openid:B}),{answerId:Ae}).then(function(d){!(d!=null&&d.success)&&d!==null&&d!==void 0&&d.message&&(C?G.u_.alert({title:"\u4FDD\u5B58\u5931\u8D25",content:(0,r.jsx)(q.Z,{html:d.message})}):T.Z.error({title:"\u4FDD\u5B58\u5931\u8D25",content:(0,r.jsx)(q.Z,{html:d.message}),okText:"\u77E5\u9053\u4E86"}))})}})})},Ue=function(){return(0,r.jsx)(Ie,{})},Je=function(){var m,v,d=(m=a.survey)===null||m===void 0||(v=m.attribute)===null||v===void 0?void 0:v.backgroundImage;if(d)return{backgroundImage:"url(/api/public/preview/".concat(d,")")}};return(0,r.jsx)(S.ff.Provider,{value:a,children:(0,r.jsxs)("div",{className:"survey ".concat(C?"mobile":"pc"),style:Je(),children:[Me(),Ue()]})})}),Re=de}}]);
