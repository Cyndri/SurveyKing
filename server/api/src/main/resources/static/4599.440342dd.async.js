(self.webpackChunksurvey_king=self.webpackChunksurvey_king||[]).push([[4599],{17707:function(O,F,n){"use strict";n.r(F),n.d(F,{default:function(){return xe}});var j=n(40807),Z=n(78210),E=n(67294),h=n(54707),x=n(48187),e=n(85893);function J(s){var t=s.schema,o=s.index,i=s.seqNo,r=(0,h.AK)("-body-questionSet"),c=(0,E.useContext)(j.ZX),A=c.questionNumber;return(0,e.jsxs)("div",{className:r,children:[(0,e.jsxs)("div",{className:r+"-title",children:[A?i||"".concat(o+1,"."):"",(0,e.jsx)(Z.Z,{html:t.title})]}),s.children,(0,e.jsx)("div",{className:r+"-splitLine"})]})}(0,x.eC)("QuestionSet",J,"antdForm");var W=n(9715),R=n(71257),N=n(94657),Q=n(9761),f=n(73057),D=function(){var t=(0,h.AK)(),o=(0,E.useContext)(j.ZX),i=o.schema;return(0,e.jsxs)("div",{className:t+"-header",children:[(0,e.jsx)("div",{className:t+"-header-title",children:(0,e.jsx)(f.hl,{html:i.title})}),(0,e.jsx)("div",{className:t+"-header-description",children:(0,e.jsx)(f.hl,{html:i.description})})]})},z=function(t){var o=(0,h.AK)();return(0,e.jsx)("div",{className:o+"-body",children:t.children})},C=n(57663),B=n(71577),V=(0,Q.Pi)(function(){var s,t,o=(0,h.AK)("-footer"),i=(0,E.useContext)(j.ZX),r=i.schema,c=i.loading,A=(0,h.Rk)(),d=A.pagination,a=d.pageSize>1,l=d.current===1,u=d.current===d.pageSize;return(0,e.jsxs)("div",{className:o,children:[u&&(0,e.jsx)("div",{className:o+"-desc",style:{userSelect:"none"},children:(0,e.jsx)(f.hl,{html:r==null||(s=r.attribute)===null||s===void 0?void 0:s.suffix})}),(0,e.jsxs)("div",{className:o+"-pagination",children:[a&&!l&&(0,e.jsx)("div",{children:(0,e.jsx)(B.Z,{type:"primary",block:!0,onClick:function(){return A.handlePrev()},children:"\u4E0A\u4E00\u9875"})}),a&&!u&&(0,e.jsx)("div",{children:(0,e.jsx)(B.Z,{type:"primary",block:!0,onClick:function(){return A.handleNext()},children:"\u4E0B\u4E00\u9875"})}),u&&(0,e.jsx)("div",{children:(0,e.jsx)(B.Z,{type:"primary",block:!0,onClick:function(){return A.submit()},loading:c,children:(0,e.jsx)(f.hl,{html:((t=r.attribute)===null||t===void 0?void 0:t.submitButton)||"\u63D0\u4EA4"})})}),a&&(0,e.jsxs)("div",{className:o+"-pagination-info",children:["\u7B2C",d.current,"\u9875/\u5171",d.pageSize,"\u9875"]})]})]})}),Be=n(47673),I=n(4107),ye=n(39002),w=n(68351),Ne=n(14965),T=n(68318),Ie=n(77883),q=n(85986),$=n(29985),_=n(46842),ee=n(64302),ne=n(27484),S=n.n(ne),Se=n(33852);S().locale("zh-cn");var te="YYYY-MM-DD",ae="YYYY-MM-DD HH:mm:ss",re="HH:mm:ss";function P(s,t){if(!!s){if(t==="date")return S()(s,te);if(t==="dateTime")return S()(s,ae);if(t==="time")return S()(s,re)}}var ie=function(t){var o=t.onChange,i=t.type,r=t.value,c=t.suffix,A=t.style,d=A===void 0?{width:"100%"}:A;return i==="number"?(0,e.jsx)(q.Z,{onChange:o,value:r,style:d,addonAfter:c}):i==="date"?(0,e.jsx)(T.Z,{onChange:function(l,u){o(u)},value:P(r,i),style:d}):i==="dateTime"?(0,e.jsx)(T.Z,{showTime:!0,onChange:function(l,u){return o(u)},value:P(r,i),style:d}):i==="time"?(0,e.jsx)(w.Z,{value:P(r,i),onChange:function(l,u){return o(u)},style:d}):i==="mobile"?(0,e.jsx)(I.Z,{prefix:(0,e.jsx)($.Z,{}),onChange:function(l){return o(l.target.value)},value:r}):i==="idCard"?(0,e.jsx)(I.Z,{prefix:(0,e.jsx)(_.Z,{}),onChange:function(l){return o(l.target.value)},value:r,style:d}):i==="email"?(0,e.jsx)(I.Z,{prefix:(0,e.jsx)(ee.Z,{}),onChange:function(l){return o(l.target.value)},value:r,style:d}):i==="password"?(0,e.jsx)(I.Z.Password,{placeholder:"\u8BF7\u8F93\u5165\u5BC6\u7801",onChange:function(l){return o(l.target.value)},value:r,suffix:c,style:d}):(0,e.jsx)(I.Z,{onChange:function(l){return o(l.target.value)},value:r,suffix:c,style:d})},Fe=n(49111),Re=function(t){var o=t.onChange,i=useRef(null),r=useRef(),c=useRef(),A=useState(0),d=_slicedToArray(A,2),a=d[0],l=d[1];return useEffect(function(){var u=i.current;if(u){var v,g=new SignaturePad(i.current);g.addEventListener("beginStroke",function(){l(1)}),r.current=g;var m=Math.max(window.devicePixelRatio||1,1);u.width=u.offsetWidth*m,u.height=u.offsetHeight*m,(v=u.getContext("2d"))===null||v===void 0||v.scale(m,m)}},[]),_jsxs("div",{className:"signature-pad",children:[_jsx("span",{style:{position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)",color:"#aaa",visibility:c.current?"hidden":"visible"},children:"\u70B9\u51FB\u7B7E\u540D"}),_jsxs("div",{className:"signature",children:[_jsx("canvas",{ref:i,style:{width:"100%",height:"100%",touchAction:"none",userSelect:"none",display:a!==2?"block":"none"}}),a===2&&_jsx("img",{src:c.current||void 0})]}),_jsxs("div",{className:"save-signature",children:[_jsx("span",{children:"\u7B7E\u540D\u5B8C\u6210\u540E\uFF0C\u8BF7\u70B9\u51FB\u3010\u5B8C\u6210\u3011\u6309\u94AE"}),_jsx("div",{children:_jsxs(_Space,{children:[a===1&&_jsx(_Button,{type:"link",onClick:function(){var v;(v=r.current)===null||v===void 0||v.clear(),l(0)},children:"\u6E05\u7A7A"}),(a===0||a===1)&&_jsx(_Button,{type:"primary",disabled:a!==1,ghost:!0,size:"small",onClick:function(){var v;o(r.current.toDataURL()),c.current=(v=r.current)===null||v===void 0?void 0:v.toDataURL(),l(2)},children:"\u5B8C\u6210"}),a===2&&_jsx(_Button,{type:"primary",ghost:!0,size:"small",onClick:function(){var v;l(0),(v=r.current)===null||v===void 0||v.clear()},children:"\u91CD\u7B7E"})]})})]})]})},se=n(3024),le=(0,Q.Pi)(function(){var s=(0,E.useContext)(j.ZX),t=s.progressBar,o=(0,h.AK)(),i=(0,h.Rk)(),r=i.progress;return t?(0,e.jsx)(se.Z,{enabled:!0,top:0,innerActiveClass:"fixed",children:(0,e.jsx)("div",{className:o+"-progress",children:(0,e.jsx)("div",{className:"progress-bar s-prog-wait",children:(0,e.jsx)("div",{className:"progress-done  s-prog-done",style:{width:"".concat(r*100,"%")}})})})}):(0,e.jsx)(e.Fragment,{})}),Ke=function(t){var o,i=t.optionId,r=t.questionId,c=t.checked,A=t.checkedCount,d=useSurvey(),a=d.statistics,l=a==null?void 0:a.questionStatistics[r],u=((l==null?void 0:l.optionStatistics.reduce(function(m,y){return m+y.count},0))||0)+A,v=(l==null||(o=l.optionStatistics.find(function(m){return m.optionId===i}))===null||o===void 0?void 0:o.count)||0;v=c?v+1:v;var g="".concat(Math.floor(v/u*1e3)/10,"%");return A===0?_jsx(_Fragment,{}):_jsxs("span",{className:"vote-info",children:[_jsxs("span",{className:"vote-info-cnt ",children:[v,"\u7968"]}),_jsx("span",{className:"vote-info-percent ",children:g}),_jsx("div",{className:"vote-info-bar",children:_jsx("div",{className:"vote-info-bar-fill",style:{width:g}})})]})},oe=function(t){var o=t.schema,i=t.type,r=o.attribute,c=r===void 0?{}:r,A=c.examCorrectAnswer,d=(0,h.Al)(),a=d.correctAnswerVisible,l=d.mode;return A&&a&&l==="exam"?i==="FillBlank"||i==="HorzBlank"||i==="MultipleBlank"?(0,e.jsx)("span",{className:"correct-answer",children:A}):(0,e.jsx)("span",{className:"correct-answer",children:"\uFF08\u6B63\u786E\u7B54\u6848\uFF09"}):(0,e.jsx)(e.Fragment,{})},ue=function(t){var o=t.schema,i=o.attribute,r=i===void 0?{}:i,c=r.examScore,A=(0,h.Al)(),d=A.mode,a=A.examScoreVisible;return c&&d==="exam"&&a?(0,e.jsxs)("span",{className:"question-score",children:["\uFF08",c,"\u5206\uFF09"]}):(0,e.jsx)(e.Fragment,{})};function de(s){var t=s.schema,o=s.index,i=s.qsIndex,r=s.required,c=s.error,A=s.replaceTitle,d=s.seqNo,a=(0,E.useContext)(j.ZX),l=a.questionNumber,u=(0,h.AK)("-body-question"),v=(0,E.useState)(),g=(0,N.Z)(v,2),m=g[0],y=g[1],k=(0,h.Rk)();(0,E.useEffect)(function(){if(m){var K,b;(K=document.querySelector("[data-id='".concat(t.id,"']")))===null||K===void 0||K.classList.remove("ant-form-item-has-error"),(b=document.querySelector("[data-id='".concat(t.id,"']")))===null||b===void 0||b.querySelectorAll("[data-id]").forEach(function(je){je.classList.remove("ant-form-item-has-error")})}if(c.length>0){var U,Ce=c[0].split("^"),L=(0,N.Z)(Ce,2),G=L[0],X=L[1],p;X?(p=document.querySelector("[data-id='".concat(G,"']")),y(X)):(p=document.querySelector("[data-id='".concat(t.id,"']")),y(G)),(U=p)===null||U===void 0||U.classList.add("ant-form-item-has-error")}else m&&y(void 0)},[c]);var M="";i!==void 0&&(M+=i+1+"-"),o!==void 0&&(M+=o+1+".");var Qe=function(){return m?(0,e.jsx)("span",{className:"question-tag error animated",children:(0,e.jsx)("span",{children:m})}):(0,e.jsx)(e.Fragment,{})};return(0,e.jsx)("div",{className:u,children:(0,e.jsx)(R.Z.Item,{label:(0,e.jsxs)("span",{className:u+"-header",children:[l?d||M:"",(0,e.jsx)(f.hl,{html:A||t.title}),(0,e.jsx)(ue,{schema:t}),Qe()]}),labelCol:{span:24},wrapperCol:{span:24},required:r,children:s.children})})}(0,x.eC)("Question",(0,Q.Pi)(de),"antdForm");var Ze=n(84305),ce=n(88182),Ae=n(82925),ve=n(94184),he=n.n(ve);S().locale("zh-cn");function me(s){var t=s.headerVisible,o=s.footerVisible,i=s.schema,r=(0,h.AK)(),c=(0,h.Al)(),A=function(){var a,l=(a=i.attribute)===null||a===void 0?void 0:a.headerImage;if(l)return(0,e.jsx)("img",{src:"/api/public/preview/".concat(l),style:{maxWidth:"100%"}})};return(0,e.jsxs)("div",{className:he()(r,{preview:c.isPreview}),children:[(0,e.jsx)(le,{}),(0,e.jsx)("div",{className:r+"-banner",children:A()}),t&&(0,e.jsx)(D,{}),(0,e.jsx)(ce.ZP,{locale:Ae.Z,children:(0,e.jsx)(z,{children:s.children})}),o&&(0,e.jsx)(V,{})]})}(0,x.eC)("Survey",me,"antdForm");var Je=n(13062),ge=n(71230),De=n(89032),Y=n(15746),fe=n(11849);function H(s){var t=s.schema,o=s.onChange,i=s.value,r=i===void 0?{}:i,c=t.children,A=(0,h.AK)("-body-question");function d(a,l){r[a]=l,l===""&&delete r[a],o((0,fe.Z)({},r))}return(0,e.jsx)("div",{children:c==null?void 0:c.map(function(a){var l=a.id,u=a.attribute,v=a.title,g=u==null?void 0:u.suffix,m=u==null?void 0:u.dataType;return(0,e.jsxs)(ge.Z,{style:{marginBottom:10},"data-id":l,children:[v&&(0,e.jsx)(Y.Z,{className:A+"-option",span:4,children:a.title&&(0,e.jsx)("span",{className:A+"-option-title",children:(0,e.jsx)(f.hl,{html:a.title})})},a.id),(0,e.jsxs)(Y.Z,{span:24,children:[(0,e.jsx)(ie,{type:m,value:r[l],onChange:function(k){return d(l,k)},suffix:g&&(0,e.jsx)("span",{className:A+"-option-suffix",children:(0,e.jsx)(f.hl,{html:g})})}),(0,e.jsx)(oe,{schema:a,type:t.type})]})]},l)})})}(0,x.RM)("FillBlank",H,"antdForm"),(0,x.RM)("MultipleBlank",H,"antdForm");var Ee=function(t){return(0,e.jsx)(e.Fragment,{children:t.children})},xe=Ee},78210:function(O,F,n){"use strict";var j=n(12968),Z=n(62462),E=n(27856),h=n.n(E),x=n(15020),e=n(85893),J=function(R){var N=R.html,Q=N===void 0?"":N,f=R.replaceP,D=f===void 0?!0:f;return D?(0,e.jsx)("div",{className:"pe-view",children:typeof Q=="string"&&(0,x.ZP)(h().sanitize(Q,{ADD_TAGS:["iframe"],ADD_ATTR:["allow","allowfullscreen","frameborder","scrolling"]}).replace(/<p>/,"<span>").replace(/<\/p>/,"</span>"),{replace:function(C){if((C==null?void 0:C.name)==="img"){var B=C.attribs.width;return(0,e.jsx)(Z.Z,{width:B?parseFloat(B):void 0,src:C.attribs.src,style:{cursor:"zoom-in"},fallback:"data:image/png;base64,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",preview:{mask:!1}})}return C}})}):(0,e.jsx)(e.Fragment,{children:typeof Q=="string"&&(0,x.ZP)(h().sanitize(Q))})};F.Z=J}}]);
