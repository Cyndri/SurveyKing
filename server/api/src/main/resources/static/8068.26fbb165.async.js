(self.webpackChunksurvey_king=self.webpackChunksurvey_king||[]).push([[8068],{68068:function(ae,X,u){"use strict";u.d(X,{O:function(){return re},Z:function(){return Fe}});var w=u(9761),b=u(67294),G=u(73057),H=u(86052),K=u(48187),Y=u(91220),k=u(93224),F=u(39428),D=u(83279),P=u(3182),V=u(11849),ee=u(94657),se=u(69610),ue=u(54941),q=u(3980),I=u(64031),y=u(54531);function le(l,e){}var M=u(40807),oe=["visible"],de=function(){function l(e){var r=this;(0,se.Z)(this,l),this.props=void 0,this.progress=0,this.form=void 0,this.pagination={current:1,pageSize:1,currentIndex:0,paginationNodes:[]},this.notNoneInQuestionGroup=[],this.answerSheet=[],this.answerSheetVisible=!1,this.reviewAnswer={},this.autoNextPage=void 0,this.compute=void 0,this.hiddenOption={};var i=e.initialValues,n=e.readOnly,t=e.fieldPermission,a=e.theme,s=e.schema,o=e.mode,d=e.onePageOneQuestion,c=d===void 0?!1:d,v=e.paginationVisible;this.props=e,this.initPagination(s,v,c);var p=(0,I.Np)({initialValues:i,readOnly:n,validateFirst:!0,pattern:e.pattern,effects:function(g){(0,I.dQ)(function(){if(t){var m=[],f=[];Object.entries(t).forEach(function(x){var $=(0,ee.Z)(x,2),Z=$[0],A=$[1];A===0?m.push(Z):A===1&&f.push(Z)}),m.length>0&&p.setFieldState("*(".concat(m.join(","),")"),function(x){return x.display="none"}),f.length>0&&p.setFieldState("*(".concat(f.join(","),")"),function(x){return x.pattern="readPretty"})}r.handleFormValuesChange(),r.highlightJs(),r.setVisible(0)}),(0,I.pO)(function(m){r.handleFormValuesChange()}),(0,I.Zj)("*",function(m,f){r.handleFieldValueChange(m,f)}),le(s,g)}});this.form=p,this.answerSheet=(0,M.Xn)(s).filter(function(h){var g,m;return(0,M.a1)(h.type)&&((g=h.attribute)===null||g===void 0?void 0:g.display)!=="hidden"&&((m=h.attribute)===null||m===void 0?void 0:m.examAnswerMode)!=="none"}).map(function(h){return{finished:!1,id:h.id,marked:!1,display:"visible",favorite:!!e.wrongMode}})||[],a==="antd"&&o==="exam"&&(this.answerSheetVisible=!0),this.autoNextPage=0,e.exerciseMode&&e.onePageOneQuestion&&(this.autoNextPage=1),this.makeObservable(),this.props.correctAnswerVisible&&i&&(0,M.Xn)(s).forEach(function(h){r.computeReviewAnswer(h,i[h.id]).then(function(g){g&&(r.reviewAnswer[h.id].visible=!0)})}),this.compute=fe(function(){r.reOrder(),r.computeProgress(),r.computePagination()},10)}return(0,ue.Z)(l,[{key:"makeObservable",value:function(){(0,y.Ou)(this,{progress:y.LO.ref,pagination:y.LO.shallow,form:y.LO.ref,props:y.LO.shallow,answerSheet:y.LO,answerSheetVisible:y.LO.ref,reviewAnswer:y.LO,notNoneInQuestionGroup:y.LO,schema:y.LO.computed,autoNextPage:y.LO.ref,hiddenOption:y.LO.shallow,exerciseMode:y.LO.computed,computeProgress:y.aD,validate:y.aD,handlePrev:y.aD,handleNext:y.aD,submit:y.aD,handleFormValuesChange:y.aD,changePageIndex:y.aD,handleFieldValueChange:y.aD,computeReviewAnswer:y.aD,reOrder:y.aD})}},{key:"schema",get:function(){return this.props.schema}},{key:"questionsGroupByPagination",get:function(){return this.pagination.paginationNodes}},{key:"exerciseMode",get:function(){return this.props.exerciseMode||!1}},{key:"initPagination",value:function(r){var i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;i?this.pagination.paginationNodes=(0,M._T)(r,n):this.pagination.paginationNodes=[r.children],this.pagination.pageSize=this.pagination.paginationNodes.length}},{key:"computePagination",value:function(){if(this.props.paginationVisible===!1)return;var r=this.form.fields;function i(v){return t[v].every(function(p){var h=r[p.id].data;return h.some(function(g){return g==="self_display"||g.startsWith("rule_")})})}for(var n=this.pagination,t=n.paginationNodes,a=n.currentIndex,s=0,o=0,d=0;d<t.length;d++){var c=t[d];if(c.some(function(v){var p=r[v.id].data;return p.length===0}))o++,s++;else{if(i(d))continue;o++,d<=a&&s++}}this.pagination=(0,V.Z)((0,V.Z)({},this.pagination),{},{current:s,pageSize:o,currentIndex:a})}},{key:"highlightJs",value:function(){document.querySelectorAll(".ql-syntax").forEach(function(r){})}},{key:"validate",value:function(){var e=(0,P.Z)((0,F.Z)().mark(function i(n){var t,a;return(0,F.Z)().wrap(function(o){for(;;)switch(o.prev=o.next){case 0:if(a=((t=this.questionsGroupByPagination[n])===null||t===void 0?void 0:t.reduce(function(d,c){return d.push.apply(d,(0,D.Z)((0,M.Xn)(c))),d},[]))||[],a.length!==0){o.next=3;break}return o.abrupt("return",!0);case 3:return o.abrupt("return",this.form.validate("*(".concat(a.map(function(d){return d.id}).join(","),")")));case 4:case"end":return o.stop()}},i,this)}));function r(i){return e.apply(this,arguments)}return r}()},{key:"setVisible",value:function(r){if(this.props.paginationVisible===!1)return!1;var i=this.pagination,n=i.currentIndex,t=i.paginationNodes,a=this.form.fields,s=r===void 0?n:r;function o(h){return t[h].every(function(g){var m=a[g.id].data;return m.some(function(f){return f==="self_display"||f.startsWith("rule_")})})}if(r!==void 0){if(r===n+1){var d=o(r);if(d){this.pagination.currentIndex=n+1,this.setVisible(r+1);return}}else if(r===n-1){var c=o(r);if(c){this.pagination.currentIndex=n-1,this.setVisible(r-1);return}}}for(var v=0;v<t.length;v++){var p=t[v];v===s?p==null||p.forEach(function(h){var g=a[h.id].data;a[h.id].data=g.filter(function(m){return m!=="hidden"})}):p.forEach(function(h){var g=a[h.id].data;g.includes("hidden")||(a[h.id].data=[].concat((0,D.Z)(g),["hidden"]))})}this.pagination.currentIndex=s}},{key:"handlePrev",value:function(){var r=this.pagination.currentIndex;this.setVisible(r-1)}},{key:"handleNext",value:function(){var e=(0,P.Z)((0,F.Z)().mark(function i(n){var t;return(0,F.Z)().wrap(function(s){for(;;)switch(s.prev=s.next){case 0:return t=this.pagination.currentIndex,s.prev=1,s.next=4,this.validate(t);case 4:this.setVisible(t+1),setTimeout(function(){return window.scroll({top:0})},10),s.next=11;break;case 8:s.prev=8,s.t0=s.catch(1),console.log(s.t0);case 11:case"end":return s.stop()}},i,this,[[1,8]])}));function r(i){return e.apply(this,arguments)}return r}()},{key:"changePageIndex",value:function(r){var i=this.questionsGroupByPagination.findIndex(function(n){return!!(n.reduce(function(t,a){return t.push.apply(t,(0,D.Z)((0,M.Xn)(a))),t},[])||[]).find(function(t){return t.id===r})});this.setVisible(i),(0,M.lA)(r,this.props.progressBar?-25:0)}},{key:"handleFormValuesChange",value:function(){var e=(0,P.Z)((0,F.Z)().mark(function i(){return(0,F.Z)().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:this.computeProgress(),this.props.onChange&&this.props.onChange(this.form.values,this.progress);case 2:case"end":return t.stop()}},i,this)}));function r(){return e.apply(this,arguments)}return r}()},{key:"handleFieldValueChange",value:function(){var e=(0,P.Z)((0,F.Z)().mark(function i(n,t){var a,s,o;return(0,F.Z)().wrap(function(c){for(;;)switch(c.prev=c.next){case 0:o=n.path.toString(),(a=(s=this.props).onFieldChange)===null||a===void 0||a.call(s,o,(0,y.ZN)(n.value)),this.props.exerciseMode&&this.computeReviewAnswer(n.componentProps.schema,n.value);case 3:case"end":return c.stop()}},i,this)}));function r(i,n){return e.apply(this,arguments)}return r}()},{key:"computeReviewAnswer",value:function(){var e=(0,P.Z)((0,F.Z)().mark(function i(n,t){var a,s,o,d,c,v,p,h;return(0,F.Z)().wrap(function(m){for(;;)switch(m.prev=m.next){case 0:if(a=!1,this.props.mode!=="exam"){m.next=12;break}if(o=this.reviewAnswer[n.id]||{},d=n.type,["FillBlank","MultipleBlank","HorzBlank","Radio","Checkbox"].includes(n.type)){m.next=6;break}return m.abrupt("return");case 6:if(d==="Radio"&&(o.visible=!0),(s=n.attribute)!==null&&s!==void 0&&s.examAnswerMode&&["selectAll","selectCorrect","onlyOne","select"].includes(n.attribute.examAnswerMode)){m.next=9;break}return m.abrupt("return");case 9:a=!0,this.reviewAnswer[n.id]=n.children.reduce(function(f,x){var $,Z=!!(($=x.attribute)!==null&&$!==void 0&&$.examCorrectAnswer);if(d==="FillBlank"||d==="MultipleBlank"||d==="Textarea"||d==="HorzBlank"){var A,z,J=(A=x.attribute)===null||A===void 0?void 0:A.examMatchRule,W=t==null?void 0:t[x.id],Q=(z=x.attribute)===null||z===void 0?void 0:z.examCorrectAnswer;!W||!Q?Z=!1:J==="contain"&&W.includes(Q.trim())||W===Q?Z=!0:Z=!1}return f[x.id]={selected:!!(t!=null&&t.hasOwnProperty(x.id)),isCorrect:Z},f},{visible:!!(o!=null&&o.visible)}),this.autoNextPage===1&&(c=this.reviewAnswer[n.id],v=c.visible,p=(0,k.Z)(c,oe),h=Object.values(p).filter(function(f){return f.selected&&f.isCorrect}).length===1,h&&d==="Radio"&&this.handleNext());case 12:return m.abrupt("return",a);case 13:case"end":return m.stop()}},i,this)}));function r(i,n){return e.apply(this,arguments)}return r}()},{key:"computeProgress",value:function(){var r=this;if(!!this.props.progressBar){var i=0,n=0;this.form.query("*").forEach(function(t){var a=r.answerSheet.find(function(s){return s.id===t.path.toString()});t.displayName==="Field"&&!t.path.toString().startsWith("_")&&(a&&(a.display=t.display),t.data.filter(function(s){return s!=="hidden"}).length===0&&i++,!(0,M.xb)(t.value)&&t.componentProps.schema.attribute.display!=="hidden"?(n++,a&&(a.finished=!0)):a&&(a.finished=!1))}),this.progress=n/i}}},{key:"reOrder",value:function(){var r,i=this,n=1;(r=this.schema.children)===null||r===void 0||r.filter(function(t){var a;return(!(0,M.nj)(t.type)||t.type==="QuestionSet")&&((a=t.attribute)===null||a===void 0?void 0:a.examAnswerMode)!=="none"}).forEach(function(t){var a;console.log(t);var s=t.id,o=i.form.query(s).get("display");if(o!=="none"&&((a=t.attribute)===null||a===void 0?void 0:a.display)!=="hidden"){var d=i.form.query(s).take();d&&(d.setDecoratorProps((0,V.Z)((0,V.Z)({},d.decoratorProps),{},{seqNo:n})),n++);var c=1;if(t.type==="QuestionSet"){var v;(v=t.children)===null||v===void 0||v.filter(function(p){return!(0,M.nj)(p.type)}).forEach(function(p){var h=p.id,g=i.form.query(h).get("display");if(g==="visible"){var m=i.form.query(h).take();m&&(m.setDecoratorProps((0,V.Z)((0,V.Z)({},m.decoratorProps),{},{seqNo:c})),c++)}})}}})}},{key:"submit",value:function(){var e=(0,P.Z)((0,F.Z)().mark(function i(){var n,t,a,s,o,d,c,v,p,h,g;return(0,F.Z)().wrap(function(f){for(;;)switch(f.prev=f.next){case 0:n="",t=this.form.query("*").map().filter(function(x){return!(0,I.JF)(x)}),a=(0,Y.Z)(t),f.prev=3,a.s();case 5:if((s=a.n()).done){f.next=31;break}if(v=s.value,!(0,I.JF)(v)){f.next=9;break}return f.abrupt("continue",29);case 9:if(n=v.path.toString(),p=((o=this.props.schema.children)===null||o===void 0||(d=o.find(function(x){return x.id===n}))===null||d===void 0||(c=d.attribute)===null||c===void 0?void 0:c.display)==="hidden",!p){f.next=13;break}return f.abrupt("continue",29);case 13:if(h=v.display,h!=="none"){f.next=16;break}return f.abrupt("continue",29);case 16:return g=v.selfDisplay,v.display="visible",f.prev=18,f.next=21,v.validate();case 21:v.display=g,f.next=29;break;case 24:return f.prev=24,f.t0=f.catch(18),this.changePageIndex(n),(0,M.lA)(n,this.props.progressBar?-25:0),f.abrupt("return");case 29:f.next=5;break;case 31:f.next=36;break;case 33:f.prev=33,f.t1=f.catch(3),a.e(f.t1);case 36:return f.prev=36,a.f(),f.finish(36);case 39:return this.props.onSubmit&&this.props.onSubmit((0,y.ZN)(this.form.values)),f.abrupt("return",{values:(0,y.ZN)(this.form.values)});case 41:case"end":return f.stop()}},i,this,[[3,33,36,39],[18,24]])}));function r(){return e.apply(this,arguments)}return r}()},{key:"markQuestion",value:function(r){var i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,n=this.answerSheet,t=n.findIndex(function(a){return a.id===r});this.answerSheet.splice(t,1,(0,V.Z)((0,V.Z)({},n[t]),{},{marked:i}))}},{key:"favoriteQuestion",value:function(r){var i=this,n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,t=this.answerSheet,a=t.findIndex(function(s){return s.id===r.templateId});n?q.hi.createUserBook((0,V.Z)((0,V.Z)({},r),{},{type:2})).then(function(s){s.success&&i.answerSheet.splice(a,1,(0,V.Z)((0,V.Z)({},t[a]),{},{favorite:n}))}):q.hi.deleteUserBook((0,V.Z)((0,V.Z)({},r),{},{type:2})).then(function(s){s.success&&i.answerSheet.splice(a,1,(0,V.Z)((0,V.Z)({},t[a]),{},{favorite:n}))})}}]),l}();function fe(l,e,r){var i=void 0,n=void 0;return function(){var t=+new Date;n||(n=t),r&&t-n>r?(l(),n=t,window.clearTimeout(i)):(window.clearTimeout(i),i=window.setTimeout(function(){l(),n=void 0},e))}}var ce=u(76826),te=u(99439),he=u(27484),ve=u.n(he),me=u(90019),R=u(10192);function ge(l,e){var r,i,n=e.id,t=[];if((r=e.parent)!==null&&r!==void 0&&(i=r.type)!==null&&i!==void 0&&i.startsWith("Matrix"))if(e.parent.type==="MatrixAuto"&&Array.isArray(l))l.forEach(function(d,c){t.push(["".concat(c,"-").concat(n),d[e.id]])});else{var a;(a=e.parent.row)===null||a===void 0||a.forEach(function(d){l[d.id]?t.push(["".concat(d.id,"-").concat(n),l[d.id][e.id]]):t.push(["".concat(d.id,"-").concat(n),void 0])})}else{var s,o=(s=e.parent)===null||s===void 0?void 0:s.type;o==="Radio"||o==="Checkbox"?Object.keys(l).includes(e.id)&&t.push([e.id,l[e.id]]):t.push([e.id,l[e.id]])}return t}function ne(l){return!isNaN(parseFloat(l))&&isFinite(l)}function pe(l){return!!(ne(l)&&Number.isInteger(parseFloat(l)))}function N(l){var e=l.errMsg,r=l.schema,i=l.regEx,n=l.value;return r?E({schema:r,value:n,errMsg:e,isValid:function(a){return a?i.test("".concat(a)):!0}}):null}function ye(l){var e,r=l.schema,i=l.value,n=l.errMsg,t=((e=r.children)===null||e===void 0?void 0:e.filter(function(d){var c;return(c=d.attribute)===null||c===void 0?void 0:c.exclusiveFillBlankInMatrix}))||[],a=JSON.parse(JSON.stringify(i));Object.values(a).forEach(function(d){t.map(function(c){return c.id}).forEach(function(c){delete d[c]})});var s=!1;if(r.type==="MatrixAuto")i&&i.length>0&&(s=!0);else{var o;s=(o=r.row)===null||o===void 0?void 0:o.every(function(d){var c=a[d.id];return!(0,M.xb)(c)})}return s?null:n}function E(l){var e=l.value,r=l.schema,i=l.isValid,n=l.errMsg;return!r||!r.parent?null:ge(e,r).map(function(t){var a=(0,ee.Z)(t,2),s=a[0],o=a[1];return i(o)?null:"".concat(s,"^").concat(n)}).filter(function(t){return t})[0]}function Ae(l){if(Object.keys(l).length===0)return!0}function be(l){var e=l.substring(6,8),r=l.substring(8,10),i=l.substring(10,12),n=new Date(parseFloat(e),parseFloat(r)-1,parseFloat(i));return!(n.getFullYear()-1900!==parseFloat(e)||n.getMonth()!==parseFloat(r)-1||n.getDate()!==parseFloat(i))}function Ve(l){var e=l;if(l.length!==15&&l.length!==18)return!1;if(l.length===15)return be(e);var r={11:"\u5317\u4EAC",12:"\u5929\u6D25",13:"\u6CB3\u5317",14:"\u5C71\u897F",15:"\u5185\u8499\u53E4",21:"\u8FBD\u5B81",22:"\u5409\u6797",23:"\u9ED1\u9F99\u6C5F ",31:"\u4E0A\u6D77",32:"\u6C5F\u82CF",33:"\u6D59\u6C5F",34:"\u5B89\u5FBD",35:"\u798F\u5EFA",36:"\u6C5F\u897F",37:"\u5C71\u4E1C",41:"\u6CB3\u5357",42:"\u6E56\u5317 ",43:"\u6E56\u5357",44:"\u5E7F\u4E1C",45:"\u5E7F\u897F",46:"\u6D77\u5357",50:"\u91CD\u5E86",51:"\u56DB\u5DDD",52:"\u8D35\u5DDE",53:"\u4E91\u5357",54:"\u897F\u85CF ",61:"\u9655\u897F",62:"\u7518\u8083",63:"\u9752\u6D77",64:"\u5B81\u590F",65:"\u65B0\u7586",71:"\u53F0\u6E7E",81:"\u9999\u6E2F",82:"\u6FB3\u95E8",91:"\u56FD\u5916 "},i=!0;if(!e||!/^([1-9]\d{5}(18|19|([23]\d))\d{2}((0[1-9])|(10|11|12))(([0-2][1-9])|10|20|30|31)\d{3}[0-9Xx])|([1-9]\d{5}\d{2}((0[1-9])|(10|11|12))(([0-2][1-9])|10|20|30|31)\d{2})$/i.test(e))i=!1;else if(!r[e.substr(0,2)])i=!1;else if(e.length>18)i=!1;else if(e.length===18){for(var n=e.split(""),t=[7,9,10,5,8,4,2,1,6,3,7,9,10,5,8,4,2],a=[1,0,"X",9,8,7,6,5,4,3,2],s=0,o=0,d=0,c=0;c<17;c+=1)o=parseInt(n[c],10),d=t[c],s+=o*d;var v=n[17].toUpperCase()==="X"?"X":Number(n[17]);a[s%11]!==v&&(i=!1)}return i}function O(l,e){return!!(!l||!e||(0,M.xb)(l[e.id]))}var xe={required:function(e,r){var i,n=r.schema,t=r.theme;return console.log(e),r&&r.required===!1?null:(0,M.xb)(e)?t==="antdForm"?"\u8BF7\u8F93\u5165":"\u8FD9\u9053\u9898\u672A\u56DE\u7B54":n!=null&&(i=n.type)!==null&&i!==void 0&&i.startsWith("Matrix")?ye({schema:n,errMsg:"\u95EE\u9898\u672A\u56DE\u7B54\u5B8C\u6574",value:e}):n!=null&&n.parent?E({schema:n,value:e,errMsg:"\u8FD9\u4E2A\u9009\u9879\u672A\u56DE\u7B54",isValid:function(s){var o;return(0,ce.Kn)(n)&&(o=n.attribute)!==null&&o!==void 0&&o.dataType&&s===!0?!1:!(0,M.xb)(s)}}):null},answerLimit:function(e,r){var i,n=r.schema,t=n==null||(i=n.attribute)===null||i===void 0?void 0:i.answerLimit;if(!t)return null;var a=t.slice(1,t.length-1).split(","),s=parseInt(a[0]||"0"),o=parseInt(a[1]||"0"),d=Object.keys(e||{}).length;return e&&(d<s&&s!==0||d>o&&o!==0)?s===0?"\u6700\u591A\u9009\u62E9".concat(o,"\u9879"):o===0?"\u6700\u5C11\u9009\u62E9".concat(s,"\u9879"):"\u6700\u5C11\u9009\u62E9".concat(s,"\u9879,\u6700\u591A\u9009\u62E9").concat(o,"\u9879"):null},number:function(e,r){var i,n=r.schema;if(O(e,n))return null;var t=n==null||(i=n.attribute)===null||i===void 0?void 0:i.numericScale,a="\u8BF7\u8F93\u5165\u6570\u5B57";return t===0?a="\u8BF7\u8F93\u5165\u6574\u6570":t&&t>0&&(a="\u8BF7\u4FDD\u7559".concat(t,"\u4F4D\u5C0F\u6570")),E({errMsg:a,schema:n,value:e,isValid:function(o){return!(o!==void 0&&(!ne(o)||t===0&&!pe(o)||t!==void 0&&t>0&&("".concat(o).split(".")[1]||"").length>t))}})},date:function(e,r){var i,n=r.schema;if(O(e,n))return null;if(n!=null&&(i=n.attribute)!==null&&i!==void 0&&i.dateTimeFormat&&e&&e[n.id]){var t=ve()(e[n.id],n.attribute.dateTimeFormat).isValid();return t?null:"\u65E5\u671F\u683C\u5F0F\u4E0D\u6B63\u786E"}return N({errMsg:"\u8BF7\u8F93\u5165\u65E5\u671F",schema:n,regEx:/^(?:(?:1[6-9]|[2-9][0-9])[0-9]{2}([-/.]?)(?:(?:0?[1-9]|1[0-2])\1(?:0?[1-9]|1[0-9]|2[0-8])|(?:0?[13-9]|1[0-2])\1(?:29|30)|(?:0?[13578]|1[02])\1(?:31))|(?:(?:1[6-9]|[2-9][0-9])(?:0[48]|[2468][048]|[13579][26])|(?:16|[2468][048]|[3579][26])00)([-/.]?)0?2\2(?:29))(\s+([01][0-9]:|2[0-3]:)?[0-5][0-9]:[0-5][0-9])?$/,value:e})},dateTime:function(e,r){var i=r.schema;return O(e,i)?null:N({errMsg:"\u8BF7\u8F93\u5165\u65E5\u671F\u65F6\u95F4",schema:i,regEx:/^\d{4}[-]([0][1-9]|(1[0-2]))[-]([1-9]|([012]\d)|(3[01]))\s(([0-1]{1}[0-9]{1})|([2]{1}[0-4]{1}))([:])(([0-5]{1}[0-9]{1}|[6]{1}[0]{1}))([:])((([0-5]{1}[0-9]{1}|[6]{1}[0]{1})))$/,value:e})},time:function(e,r){var i=r.schema;return O(e,i)?null:N({errMsg:"\u8BF7\u8F93\u5165\u65F6\u95F4",schema:i,regEx:/^(([0-1]{1}[0-9]{1})|([2]{1}[0-4]{1}))([:])(([0-5]{1}[0-9]{1}|[6]{1}[0]{1}))([:])((([0-5]{1}[0-9]{1}|[6]{1}[0]{1})))$/,value:e})},mobile:function(e,r){var i=r.schema;return O(e,i)?null:N({errMsg:"\u624B\u673A\u53F7\u683C\u5F0F\u4E0D\u6B63\u786E",schema:i,regEx:/^1[0-9]{10}$/,value:e})},decimal:function(e,r){var i=r.schema;return O(e,i)?null:N({errMsg:"\u8BF7\u8F93\u5165\u6570\u5B57",schema:i,regEx:/^[+-]?\d+(\.\d+)?$/,value:e})},email:function(e,r){var i=r.schema;return O(e,i)?null:N({errMsg:"\u90AE\u4EF6\u683C\u5F0F\u4E0D\u6B63\u786E",schema:i,regEx:/^\w+([-+.]\w+)*@\w+([-.]\w+)*\.\w+([-.]\w+)*$/,value:e})},idCard:function(e,r){var i=r.schema;return O(e,i)?null:E({errMsg:"\u8EAB\u4EFD\u8BC1\u683C\u5F0F\u4E0D\u6B63\u786E",schema:i,value:e,isValid:function(t){return!(t&&!Ve("".concat(t)))}})},chinese:function(e,r){var i=r.schema;return O(e,i)?null:N({errMsg:"\u8BF7\u8F93\u5165\u6C49\u5B57",schema:i,regEx:/^[\u4e00-\u9fa5]+$/,value:e})},alphabet:function(e,r){var i=r.schema;return O(e,i)?null:N({errMsg:"\u8BF7\u8F93\u5165\u5B57\u6BCD",schema:i,regEx:/^[a-zA-Z]+$/,value:e})},textLimit:function(e,r){var i,n=r.schema;if(O(e,n))return null;var t=n==null||(i=n.attribute)===null||i===void 0?void 0:i.textLimit;if(!t)return null;var a=t.slice(1,t.length-1).split(","),s=parseInt(a[0]||"0"),o=parseInt(a[1]||"0");if(s===0&&o===0)return null;var d=E({errMsg:s!==o?"\u8BF7\u8F93\u5165".concat(s,"~").concat(o,"\u4E2A\u5B57"):"\u8BF7\u8F93\u5165".concat(s,"\u4E2A\u5B57"),schema:n,value:e,isValid:function(v){return!(v&&("".concat(v).length<s||"".concat(v).length>o))}});return d},scope:function(e,r){var i,n,t,a=r.schema,s=a==null||(i=a.attribute)===null||i===void 0?void 0:i.scope,o=a==null||(n=a.attribute)===null||n===void 0?void 0:n.dataType;if(s&&o){if(o==="number")return E({errMsg:"\u6570\u503C\u8303\u56F4\u4E0D\u6B63\u786E ".concat(s),schema:a,value:e,isValid:function(f){return!(f!==void 0&&!(0,R.$l)(s,"".concat(f)))}});if(o==="date")return E({errMsg:"\u65E5\u671F\u8303\u56F4\u4E0D\u6B63\u786E ".concat(s),schema:a,value:e,isValid:function(f){return!(f&&!(0,R.sm)(s,"".concat(f)))}});if(o==="dateTime")return E({errMsg:"\u65E5\u671F\u65F6\u95F4\u8303\u56F4\u4E0D\u6B63\u786E ".concat(s),schema:a,value:e,isValid:function(f){return!(f&&!(0,R.de)(s,"".concat(f)))}});if(o==="time")return E({errMsg:"\u65F6\u95F4\u8303\u56F4\u4E0D\u6B63\u786E ".concat(s),schema:a,value:e,isValid:function(f){return!(f&&!(0,R.YM)(s,"".concat(f)))}})}else if((a==null?void 0:a.type)==="MatrixAuto"&&(t=a.attribute)!==null&&t!==void 0&&t.scope){var d,c=(d=a.attribute)===null||d===void 0?void 0:d.scope,v=(0,R.$l)(c,"".concat(Object.keys(e).length));if(v)return null;var p=c.substring(1,c.indexOf(",")),h=c.substring(c.indexOf(",")+1,c.length-1),g=[];return p&&g.push("\u6700\u5C11".concat(p,"\u884C")),h&&g.push("\u6700\u591A".concat(h,"\u884C")),g.join("\uFF0C")}return null},horzBlank:function(e,r){return(0,P.Z)((0,F.Z)().mark(function i(){var n,t,a,s,o,d,c,v;return(0,F.Z)().wrap(function(h){for(;;)switch(h.prev=h.next){case 0:if(t=r.schema,!((t==null||(n=t.attribute)===null||n===void 0?void 0:n.dataType)!=="horzBlank"||e[t.id]===void 0||!t.children||!t.parent)){h.next=3;break}return h.abrupt("return",null);case 3:a=null,s=0;case 5:if(!(s<((o=t.children)===null||o===void 0?void 0:o.length))){h.next=15;break}return d=t.children[s],c=(0,me.j)(d,t),h.next=10,(0,te.Gu)(e[t.id],c,{validateFirst:!0});case 10:v=h.sent,v.error&&v.error.length>0&&(a=v.error[0]);case 12:s++,h.next=5;break;case 15:return h.abrupt("return",a);case 16:case"end":return h.stop()}},i)}))()}};(0,te.au)(xe);var Me=u(8166),ie=u(8373),T=u(85893);window.katex=Me.Z;var re=(0,b.forwardRef)(function(l,e){var r=l.theme,i=r===void 0?K.uH:r,n=l.footerVisible,t=n===void 0?!0:n,a=l.headerVisible,s=a===void 0?!0:a,o=l.loading,d=l.questionNumber,c=d===void 0?!0:d,v=l.onUpload,p=l.progressBar,h=p===void 0?!1:p,g=l.statistics,m=l.isPreview,f=l.mode,x=f===void 0?"survey":f,$=l.correctAnswerVisible,Z=$===void 0?!1:$,A=l.examScoreVisible,z=A===void 0?!1:A,J=l.requiredVisible,W=J===void 0?!0:J,Q=l.onDictSearch,Oe=l.onLink,Pe=l.triggerType,_=(0,b.useMemo)(function(){return new de(l)},[]),S=_.form,j=(0,b.useMemo)(function(){return(0,M.Gt)(l.schema)},[l.schema]),Ze=(0,b.useMemo)(function(){var C={},B=function U(L){C[L.id]=L.title,L.children&&L.children.forEach(U)};return B(j),document.title=(0,q.WO)(j.title),C},[j]),Ee=(0,b.useMemo)(function(){return(0,M.R6)(l.schema)},[l.schema]);(0,b.useImperativeHandle)(e,function(){return{submit:function(){return _.submit()},reset:function(){S.reset()},setValues:function(B){S.setValues(B,"overwrite")},setValue:function(B,U){S.setFieldState(B,function(L){return L.value=U})},toggleReadOnly:function(B){S.setState(function(U){U.pattern=B?"readPretty":"editable"})},getValues:function(){return S.values}}}),(0,b.useEffect)(function(){l.onInit&&l.onInit(S)},[]);var $e=(0,b.useMemo)(function(){return{theme:i,schema:j,footerVisible:t,questionNumber:c,headerVisible:s,optionTypes:Ee,onUpload:v,loading:o,id2title:Ze,progressBar:h,innerStore:_,statistics:g,isPreview:m,mode:x,correctAnswerVisible:Z,examScoreVisible:z,onDictSearch:Q,requiredVisible:W,onLink:Oe,triggerType:Pe}},[o,j,g]);return(0,T.jsx)(b.Suspense,{fallback:(0,T.jsx)(ie.gb,{}),children:(0,T.jsx)(ie.ZP,{theme:i,children:(0,T.jsx)(w.RV,{form:S,children:(0,T.jsx)(H.Z.Provider,{value:$e,children:(0,T.jsx)(G.k9,{schema:j})})})})})}),Fe=re},8373:function(ae,X,u){"use strict";u.d(X,{gb:function(){return Y}});var w=u(67294),b=u(85893),G=w.lazy(function(){return Promise.all([u.e(7291),u.e(4409),u.e(8369),u.e(7422),u.e(6661),u.e(3136),u.e(2804),u.e(4535),u.e(8550),u.e(5990),u.e(3671),u.e(7511),u.e(8867),u.e(7856),u.e(1044),u.e(2595),u.e(6389),u.e(1495)]).then(u.bind(u,94905))}),H=w.lazy(function(){return Promise.all([u.e(9548),u.e(7291),u.e(4409),u.e(4177),u.e(8369),u.e(6779),u.e(7422),u.e(1257),u.e(6661),u.e(3136),u.e(2804),u.e(3710),u.e(8550),u.e(5990),u.e(3671),u.e(2684),u.e(8867),u.e(7856),u.e(6625),u.e(1044),u.e(596),u.e(811),u.e(6389),u.e(8463)]).then(u.bind(u,68209))}),K=w.lazy(function(){return Promise.all([u.e(4409),u.e(1257),u.e(6661),u.e(4535),u.e(5990),u.e(7856),u.e(1044),u.e(4499),u.e(4599)]).then(u.bind(u,17707))}),Y=function(){return(0,b.jsx)("div",{className:"page-loading-warp",children:(0,b.jsxs)("div",{className:"spinner",children:[(0,b.jsx)("div",{className:"rect1"}),(0,b.jsx)("div",{className:"rect2"}),(0,b.jsx)("div",{className:"rect3"}),(0,b.jsx)("div",{className:"rect4"}),(0,b.jsx)("div",{className:"rect5"})]})})},k=function(D){var P=D.theme,V=D.children;return P==="antdMobile"?(0,b.jsx)(H,{children:V}):P==="antdForm"?(0,b.jsx)(K,{children:V}):(0,b.jsx)(G,{children:V})};X.ZP=k}}]);
